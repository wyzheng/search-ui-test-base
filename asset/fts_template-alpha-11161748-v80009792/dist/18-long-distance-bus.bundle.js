(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{1066:function(e,t,i){},1067:function(e,t,i){},1068:function(e,t,i){},1069:function(e,t,i){},1700:function(e,t,i){"use strict";i(1066)},1701:function(e,t,i){"use strict";i(1067)},1702:function(e,t,i){"use strict";i(1068)},1703:function(e,t,i){"use strict";i(1069)},2203:function(e,t,i){"use strict";i.r(t);var o,r=i(18),n=i.n(r),s=i(1),c=i.n(s),a=i(9),u=i(46),l=i.n(u),p=i(0),f=i(10),d=i(3),h=i(84),m=i(8),v=i(80),g={props:{title:{type:String,default:""},desc:{type:String,default:""},options:{type:Array,default:function(){return[]}}},data:function(){return{list:JSON.parse(JSON.stringify(this.options))}},computed:{header:function(){return{close:!0,title:this.title,desc:this.desc}}},watch:{options:function(){this.list=JSON.parse(JSON.stringify(this.options)),this.refresh()}},methods:{show:function(){this.$refs.halfScreen.show()},hide:function(){this.$refs.halfScreen.hide()},refresh:function(){this.list.forEach((function(e){e.selectedValues||(e.selectedValues=[])}))},onTapValue:function(e,t,i){var o=e.selectedValues;o.indexOf(t)>-1?o.splice(o.indexOf(t),1):(e.maxCount&&o.length>=e.maxCount&&o.shift(),o.push(t)),e.selectedValues=o,this.$set(this.list,i,e)},onTapConfirm:function(){this.$emit("tap:confirm",this.list)}}},k=(i(1700),i(1701),i(4)),C=Object(k.a)(g,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ui-half-screen",{ref:"halfScreen",attrs:{"class-name":"popup-checkbox-list",header:e.header,footer:{confirm:"确定"},"can-scroll":!0},on:{"tap:confirm":e.onTapConfirm}},[i("div",{staticClass:"popup-checkbox-list-inner"},e._l(e.list,(function(t,o){return i("dl",{key:t.id+o},[i("dt",[e._v(e._s(t.title))]),i("dd",[i("ui-column",{attrs:{col:3,list:t.values,gap:16},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.item;return[i("div",{staticClass:"option",class:{active:t.selectedValues.indexOf(n)>-1},on:{click:function(i){return e.onTapValue(t,n,o)}}},[e._v(e._s(n))])]}}],null,!0)})],1)])})),0)])}),[],!1,null,"d89e8a50",null).exports,b=i(632),y=i(2);function S(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}var _=new f.a({city:1,choice:4,input:5,button:6}),P=new f.a({checkbox:1,radio:2}),x=(o={},c()(o,_.city,"locationSelector"),c()(o,_.choice,"choiceSelector"),o),I={default:0,loading:1,success:2,fail:3},w={components:{BlockTitle:v.default,blockSource:h.default,PopupCheckboxList:C,UiDropdown:b.a},mixins:[p.m,p.k],props:{d:{type:Object,default:function(){return{}}},typePos:{type:Number,default:0}},data:function(){var e,t=(null===(e=this.$props.d.items)||void 0===e?void 0:e[0])&&JSON.parse(JSON.stringify(this.$props.d.items[0]));return{PickerType:_,PickerStatus:I,data:this.d,item:t,popupCheckboxListData:{},sourceSelectedIndex:0,isLoading:!1,isReverse:!1,transferReportId:"transfer:transfer:".concat(p.g.getRandom(6))}},computed:{fromPicker:function(){var e;return(null===(e=this.item.forms)||void 0===e?void 0:e.find((function(e){return"from"===e.id})))||{}},toPicker:function(){var e;return(null===(e=this.item.forms)||void 0===e?void 0:e.find((function(e){return"to"===e.id})))||{}},canSourceChange:function(){return this.$props.d.items.length>1}},watch:{d:function(){this.item=this.$props.d.items&&this.$props.d.items[0]&&JSON.parse(JSON.stringify(this.$props.d.items[0])),this.sourceSelectedIndex=0},item:function(){this.refresh()}},created:function(){this.weuiPicker=null,this.referChangeMap={},m.b.onInputChange(this.hide),m.b.onInputConfirm(this.hide),p.a.$on(d.b.REAL_SWITCH_TAB,this.hide),p.a.$on(d.b.APP_VIEW_CHANGED,this.hide),this.refresh()},methods:{getReverseJumpInfo:function(e){if(e.jumpInfo)return Object.assign({},e.jumpInfo,this.isReverse?{weappUrl:e.weappUrl}:{})},onTap:function(){if(this.item.jumpInfo){var e=this.getReverseJumpInfo(this.item);this.M_go(e),this.M_clickReport({clickZone:"$.items[0]",clickContent:this.item.title},this.item)}},onTapTranser:function(){this.isReverse=!this.isReverse;var e=this.fromPicker.anchor,t=this.toPicker.anchor;this.$set(this.fromPicker,"anchor",t),this.$set(this.toPicker,"anchor",e),this.M_clickReport({clickZone:"$.items[0].transer",clickContent:"transfer",reportId:this.transferReportId,actionType:y.g.CLICK_TRANSFER})},hide:function(){this.weuiPicker&&this.weuiPicker.hide(),this.$refs.popupCheckboxList&&this.$refs.popupCheckboxList.hide()},refresh:function(){var e=this;this.isLoading=!1,this.tip=null,this.$refs.input&&(this.$refs.input[0].value=""),this.item.forms.forEach((function(t){if(t.referSelector&&t.referSelector.referId){var i=t.referSelector.referId;e.referChangeMap[i]||(e.referChangeMap[i]=[]),e.referChangeMap[i].push(t)}t.type==_.city?(t.formSelector=t.locationSelector,!t.formSelector.realAnchor&&t.formSelector.anchor?(t.formSelector.formValue=e.getLocationArray(t.formSelector.anchor),t.formSelector.formValue.length&&e.onLocationPickerChange(t)):t.formSelector.formValue=[]):t.type==_.choice&&(t.formSelector=t.choiceSelector)}))},getChoiceValues:function(e){return e&&e.formSelector&&e.formSelector.options?e.formSelector.options.reduce((function(e,t){return e.concat(t.formValue||[])}),[]):[]},getPickerById:function(e){return this.item.forms.find((function(t){return t.id==e}))},getPickerValueById:function(e){var t=this.getPickerById(e);if(t&&t[x[t.type]]&&t[x[t.type]].formValue)return t[x[t.type]].formValue},getLocationArray:function(e){if(!e)return[];var t=[];return e.province&&t.push(e.province),e.city&&t.push(e.city),e.distinct&&t.push(e.distinct),t},getLocationParams:function(e){return{province:e[0]&&e[0].toString()||"",city:e[1]&&e[1].toString()||"",distinct:e[2]&&e[2].toString()||""}},onReferPickerChange:function(e){var t=this;this.referChangeMap[e.id]&&this.referChangeMap[e.id].forEach((function(e){var i=e.referSelector,o=t.getPickerValueById(i.referId);Array.isArray(o)&&(o=o.join(""));var r=i.referMap.find((function(e){return e.referValue.indexOf(o)>-1}));e.formSelector=r?r[x[e.type]]:e[x[e.type]]}))},onLocationPickerChange:function(e){var t=this;if(e.locationChange){var i=e.locationChange;e.status=I.loading,this.$forceUpdate(),p.h.getCommonCgiData({cgiName:i.cgi.name,data:Object.assign(this.getLocationParams(e.formSelector.formValue),i.cgi.params)}).then((function(i){i.errCode&&0!==i.errCode||!i.extra?e.status=I.fail:(e.status=I.success,e.extra=i.extra),t.$forceUpdate()})).catch((function(i){e.status=I.fail,t.$forceUpdate()}))}},onTapPicker:function(e){var t,i=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=this.item.forms)||void 0===t?void 0:t.indexOf(e),r=this;if(e.jumpInfo){var n=r.getReverseJumpInfo(e);return r.M_go(n),void r.M_clickReport({clickZone:"$.items[0].forms[".concat(o,"]"),clickContent:e.anchor||e.hint},e)}if(e.referSelector){var s=e.referSelector.referId;if(s&&(!this.getPickerValueById(s)||!this.getPickerValueById(s).length))return void this.onTapPicker(this.getPickerById(s))}switch(e.type){case _.city:var c=e.formSelector;a.a.cityPicker({id:+new Date,className:"long-distance-bus__picker",title:c.title,desc:c.desc,supports:c.support,defaultValue:c.formValue.length?c.formValue:this.getLocationArray(c.realAnchor||c.anchor),rules:c.showList,onConfirm:function(t){c.formValue=t.filter((function(e){return e.label})),r.$set(r.item.forms,o,e),i.onLocationPickerChange(e),i.onReferPickerChange(e)}}).then((function(e){i.weuiPicker=e}));break;case _.choice:var u=e.formSelector;if(u.subType===P.radio){var p=u.options[0];this.weuiPicker&&this.weuiPicker.hide(),this.weuiPicker=l.a.picker(p.values,{title:u.title,desc:u.desc,className:"choice-selector-radio-picker",onConfirm:function(e){p.formValue=e.map((function(e){return e.toString()})),i.$forceUpdate()},id:"choice-selector-radio-picker"})}else this.popupCheckboxListData=u,this.$refs.popupCheckboxList.show()}this.M_clickReport({clickZone:"$.items[0].forms[".concat(o,"]"),clickContent:e.hint,actionType:y.g.CLICK_SHOW_DIALOG})},onTapSubmit:function(){var e=this,t=this.item.submit;if(t.jumpInfo){var i=this.getReverseJumpInfo(t);this.M_go(i)}else if(t.cgi){var o=function(){if(e.isLoading)return{v:void 0};for(var i=[],o=!0,r=0,n=e.item.forms.length;r<n;++r){var s=e.item.forms[r],c=s.id;switch(s.type){case _.city:var a=s.formSelector,u=a.formValue,l=a.required||{};if(!u[0]||l.city&&!u[1]||l.distinct&&!u[2]){o=!1,e.onTapPicker(s);break}i.push({id:c,location:e.getLocationParams(u)});break;case _.choice:s.formSelector.options.forEach((function(e){i.push({id:e.id,values:e.formValue})}));break;default:i.push({id:s.id,value:s.formValue})}}if(!o)return{v:void 0};var f=t.cgi;e.isLoading=!0,p.h.getCommonCgiData({cgiName:f.name,data:Object.assign({forms:i},f.params)}).then((function(t){e.isLoading=!1,0!==t.errCode?e.$store.commit("updateDialog",{title:t.errMsg,cancel:!1}):e.M_go(t.jump)})).catch((function(){e.isLoading=!1,e.$store.commit("updateDialog",{title:"网络超时，请稍后再试",cancel:!1})}))}();if("object"===n()(o))return o.v}this.M_handleInsert(),this.M_clickReport({expand:this.item.subScene||"",clickZone:"$.items[0].submit.button",clickContent:t.button,actionType:y.g.WE_APP},t)},onTapSource:function(){var e;if(this.canSourceChange){this.M_clickReport({clickZone:"$.items[0].source",clickContent:null===(e=this.$data.item.source)||void 0===e?void 0:e.title});var t=this;this.$store.commit({type:"updateActionSheet",title:"选择服务提供方",sheets:t.$props.d.items.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?S(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):S(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({tags:e.tags},e.source)})),className:"long-distance-bus-action-sheet",clickCallback:function(e){var i;t.sourceSelectedIndex=e.pos-1,t.item=JSON.parse(JSON.stringify(t.$props.d.items[t.sourceSelectedIndex])),t.M_clickReport({clickZone:"actionSheet",clickContent:null===(i=t.item.source)||void 0===i?void 0:i.title,actionType:y.g.CONFIRM_CHANGE_CODE});var o=t.item.source.cgi;o&&o.name&&p.h.commonCgi({cgiName:o.name,data:o.params})}})}else this.M_clickSourceReport()},onTapPopupCheckboxListConfirm:function(e){var t=this;this.$refs.popupCheckboxList.hide(),e.forEach((function(e){var i=t.popupCheckboxListData.options.find((function(t){return t.id==e.id}));i&&(i.formValue=e.selectedValues)})),this.$forceUpdate()},onInputChange:function(e){e.formValue=this.$refs.input[0].value}}},O=(i(1702),i(1703),Object(k.a)(w,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"active",rawName:"v-active.stop",value:!!e.item.jumpInfo,expression:"!!item.jumpInfo",modifiers:{stop:!0}}],staticClass:"long-distance-bus active__mask",attrs:{"data-id":e.M_exposeId(),"data-back-report-id":e.M_docReportId(),"data-report-id":e.M_itemReportId(e.item)},on:{click:function(t){return t.stopPropagation(),e.onTap.apply(null,arguments)}}},[e.d.title?i("block-title",{attrs:{d:e.d,"type-pos":e.typePos}}):e._e(),i("div",{staticClass:"ctn"},[i("div",{staticClass:"desc-box"},[i("p",{staticClass:"title",domProps:{innerHTML:e._s(e.xss(e.item.title))}}),i("p",{staticClass:"desc"},[e._v(e._s(e.item.desc))]),i("ui-tags",{attrs:{flex:"",tags:e.item.tags}})],1),i("div",{staticClass:"form-box"},[e._l(e.item.forms,(function(t,o){return[t.type===e.PickerType.city||t.type===e.PickerType.button?i("ui-dropdown",{key:e.item.docID+t.id,staticClass:"form-selector border-form-box",attrs:{placeholder:t.hint,tabindex:"-1","data-report-id":e.M_itemReportId(t,o+1)},nativeOn:{click:function(i){return i.stopPropagation(),e.onTapPicker(t,o)}}},[i("div",{staticClass:"form-selector-content location-selector-content"},[t.formSelector?i("p",{class:{"form-selector-value":t.formSelector.formValue&&t.formSelector.formValue.join("·")}},[e._v("\n              "+e._s(t.formSelector.formValue&&t.formSelector.formValue.join("·")||t.hint)+"\n            ")]):i("p",[t.anchor?i("span",{staticClass:"value"},[e._v(e._s(t.anchor))]):i("span",{staticClass:"placeholder"},[e._v(e._s(t.hint))])]),t.locationChange&&t.status?i("div",{staticClass:"location-selector-content-change-tips"},[t.status===e.PickerStatus.loading?[i("span",{staticClass:"circle-loading"}),e._v(e._s(t.locationChange.loadingText||"查询中")+"\n              ")]:t.status===e.PickerStatus.fail?[e._v("\n                未能查到结果\n              ")]:[i("span",{domProps:{innerHTML:e._s(e.xss(t.extra))}})]],2):e._e()])]):t.type===e.PickerType.choice?i("ui-dropdown",{key:e.item.docID+t.id,staticClass:"form-selector",attrs:{placeholder:t.hint,value:e.getChoiceValues(t).join("/")},nativeOn:{click:function(i){return i.stopPropagation(),e.onTapPicker(t)}}}):t.type===e.PickerType.input?i("div",{key:e.item.docID+t.id,staticClass:"form-input-box"},[i("input",{ref:"input",refInFor:!0,staticClass:"form-input weui-input",attrs:{type:"text",placeholder:t.hint},on:{input:function(i){return e.onInputChange(t)}}})]):e._e(),e.item.reverse&&0===o?i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],key:o,staticClass:"icon-transfer active__mask",attrs:{role:"button",tabindex:"-1","aria-label":"交换地区","data-report-id":e.M_itemReportId(e.transferReportId)},on:{click:function(t){return t.stopPropagation(),e.onTapTranser.apply(null,arguments)}}},[i("ui-image",{attrs:{size:24,url:"https://res.wx.qq.com/t/fed_upload/3333f405-c5e1-4c86-9232-05e5bdad7a14/transfer.svg"}})],1):e._e()]}))],2),i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"weui-btn active__mask",attrs:{role:"button","data-report-id":e.M_itemReportId(e.item.submit)},on:{click:function(t){return t.stopPropagation(),e.onTapSubmit.apply(null,arguments)}}},[e.isLoading?i("span",{staticClass:"circle-loading"}):i("span",[e._v(e._s(e.item.submit.button))])])]),e.item.source&&e.item.source.title?i("blockSource",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],key:e.item.docID+"block-source",class:{active__mask:!!e.canSourceChange},attrs:{d:e.d,source:e.item.source},nativeOn:{click:function(t){return t.stopPropagation(),e.onTapSource.apply(null,arguments)}},scopedSlots:e._u([{key:"extra-info",fn:function(){return[e.d.items.length>1?i("ui-arrow",{attrs:{direction:"down",align:"flex",gap:""}}):e._e()]},proxy:!0}],null,!1,887898944)}):e._e(),i("popup-checkbox-list",{ref:"popupCheckboxList",attrs:{title:e.popupCheckboxListData.title,desc:e.popupCheckboxListData.desc,options:e.popupCheckboxListData.options},on:{"tap:confirm":e.onTapPopupCheckboxListConfirm}})],1)}),[],!1,null,"248d8bb7",null));t.default=O.exports},575:function(e,t,i){},625:function(e,t,i){"use strict";i(575)},632:function(e,t,i){"use strict";var o={name:"UiDropdown",props:{value:{type:String,default:""},placeholder:{type:String,default:""},direction:{type:String,default:"down"},role:{type:String,default:"button"}}},r=(i(625),i(4)),n=Object(r.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"ui-dropdown",attrs:{role:e.role,tabindex:"-1"}},[i("p",{staticClass:"wording",class:{placeholder:!e.value}},[e.$slots.default?[e._t("default")]:[e._v("\n      "+e._s(e.value?e.value:e.placeholder)+"\n    ")]],2),i("ui-arrow",{attrs:{direction:e.direction,align:"flex"}})],1)}),[],!1,null,"586742ec",null).exports;n.install=function(e){e.component(n.name,n)};t.a=n}}]);