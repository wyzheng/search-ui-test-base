(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{511:function(t,e,i){"use strict";i.r(e);var o=i(1),r=i.n(o),n=i(0),a=i(2),c=i(55),s=i(46),l=i.n(s);function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){r()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var p={name:"SmartVolunteer",components:{poi:c.a},mixins:[n.m,n.k],props:{source:{type:Object,default:function(){return{}}},data:{type:Object,default:function(){return{}}},item:{type:Object,default:function(){return{}}},pos:{type:Number,default:0},typePos:{type:Number,default:0}},data:function(){return{validateFnList:[],btnLoading:!1,confirmButton:{},refreshParams:{}}},computed:{itemInfo:function(){return n.g.isObjectEmpty(this.source)?this.item:this.source},formList:function(){return this.itemInfo.formList}},watch:{"itemInfo.button":{handler:function(t){this.confirmButton=t},immediate:!0},formList:{handler:function(t){var e=this;if(t){this.validateFnList=[],this.btnLoading=!1,this.refreshParams={};var i=[{key:"location",validate:this.validateLocation},{key:"pop",validate:this.validatePop},{key:"picker",validate:this.validatePicker},{key:"input",validate:this.validateInput}];t.forEach((function(t){var o=i.findIndex((function(e){var i=e.key;return t[i]}));o>-1&&(e.refreshParams[i[o].key]=t.selector.value,i[o].validate(t))}))}},immediate:!0}},methods:{onCityClicked:function(t){var e=t.selector.value;this.M_clickReport({clickContent:e,actionType:a.g.CLICK_CITY_CODE},t)},onCityChanged:function(t,e){var i=this;if(t&&t[0]){var o=e.selector.value,r=t[0].value;this.refreshParams.location=r,e.selector.value=r,e.location.anchor.province=r,this.M_clickReport({clickContent:r,actionType:a.g.CONFIRM_CHANGE_CODE,cardExtInfo:{fromCode:o,toCode:r}},e);var c=e.location;if(c.cgi){var s=l.a.loading("加载中"),u={location:r};n.h.getServiceCommCgiData({cgiName:c.cgi.name,data:f({data:JSON.stringify(u)},c.cgi.params),target:this,refreshType:"doc"}).then((function(t){s.hide(),t.errCode&&0!==t.errCode?i.$store.commit("updateDialog",{title:"系统繁忙，请稍后再试",cancel:!1}):i.$emit("refresh:itemInfo",i.M_getItemInfo(t.refreshItem))})).catch((function(t){s.hide(),i.$store.commit("updateDialog",{title:"请求超时，请稍后再试",cancel:!1})}))}}},validateLocation:function(t){var e=this;this.validateFnList.push((function(){return!(t.location&&!e.refreshParams.location)||(e.$store.commit("updateDialog",{title:t.location.emptyMessage||"请选择地址",cancel:!1,confirm:t.confirmText||"我知道了"}),!1)}))},validateInput:function(t){var e=this;this.validateFnList.push((function(){if(t.input&&t.input.validate&&1===t.input.validate.type){var i=+e.refreshParams.input;if(""==e.refreshParams.input||!/\d+/.test(i))return e.$store.commit("updateDialog",{title:t.input.emptyMessage,cancel:!1,confirm:t.confirmText||"我知道了"}),!1;if(void 0!==t.input.validate.numberMax&&i>t.input.validate.numberMax)return e.$store.commit("updateDialog",{title:t.input.rangesMessage,cancel:!1,confirm:t.confirmText||"我知道了"}),!1;if(void 0!==t.input.validate.numberMin&&i<t.input.validate.numberMin)return e.$store.commit("updateDialog",{title:t.input.rangesMessage,cancel:!1,confirm:t.confirmText||"我知道了"}),!1}return!0}))},validatePicker:function(t){var e=this;this.validateFnList.push((function(){return!(t.picker&&!e.refreshParams.picker)||(e.$store.commit("updateDialog",{title:t.picker.emptyMessage||"请选择科目",cancel:!1,confirm:t.confirmText||"我知道了"}),!1)}))},validatePop:function(t){var e=this;this.validateFnList.push((function(){return!(t.pop&&!e.refreshParams.pop)||(e.$store.commit("updateDialog",{title:t.pop.emptyMessage||"请选择科目",cancel:!1,confirm:t.confirmText||"我知道了"}),!1)}))},onInput:function(t,e){e.selector.value=t.target.value.trim(),this.refreshParams.input=t.target.value.trim()},onFocus:function(t,e){var i=t.target.value.trim();this.M_clickReport({clickContent:i,actionType:a.g.CLICK_INPUT,cardExtInfo:{content:i}},e)},onClickSelector:function(t){var e=this,i=this;if(t.picker)l.a.picker(t.picker.showList,{id:Date.now(),title:t.picker.popTitle||"",defaultValue:[t.selector.value],container:"body",onConfirm:function(e){var o=t.selector.value;t.selector=e[0],i.refreshParams.picker=t.selector.value;var r=t.picker.showList.findIndex((function(t){return t.value===t.selector.value})),n="";r>-1&&(n=i.M_parentItemPos("".concat(r+1,":").concat(i.M_getItemType(t.selector.reportId)))),i.M_clickReport({clickContent:t.selector.value,actionType:a.g.CONFIRM_CHANGE_CODE,itemPos:n,cardExtInfo:{fromCode:o,toCode:t.selector.value}},t)}}),this.M_clickReport({clickContent:t.selector.value,actionType:a.g.CLICK_CHOOSE,cardExtInfo:{content:t.selector.value}},t);else if(t.pop){t.pop.itemInfo&&(t.pop.itemInfo._selectedList=t.selector.value&&t.selector.value.split("/")),this.M_serviceSearchGo(f(f({},t),{},{targetCallback:function(i){var o=i.selectedList;if(o){var r=[];o.forEach((function(t){t.forEach((function(t){r.push(t.title)}))})),t.selector.value=r.join("/"),e.refreshParams.pop=r.join("/"),e.M_clickReport({clickContent:t.selector.value,actionType:a.g.CONFIRM_CHANGE_CODE,cardExtInfo:{content:t.selector.value}},t)}}})),this.M_clickReport({clickContent:t.selector.value,actionType:a.g.CLICK_CHOOSE,cardExtInfo:{content:t.selector.value}},t)}else t.location},onTapTitleIcon:function(t){this.M_serviceSearchGo(t),this.M_clickReport({clickContent:t.title||""},t)},onTapConfirm:function(t){var e=this;if(this.refreshParams,t){for(var i=!0,o=0;o<this.validateFnList.length;o++)if(!(i=i&&this.validateFnList[o]()))return;t.cgi&&(this.btnLoading=!0,n.h.getServiceCommCgiData({cgiName:t.cgi.name,data:f({data:JSON.stringify(this.refreshParams)},t.cgi.params),target:this,refreshType:"doc"}).then((function(t){var i;if(e.btnLoading=!1,0===t.errCode){try{t.refreshExtData=JSON.parse(t.refreshExtData)}catch(t){return}var o=(null===(i=t.refreshExtData)||void 0===i?void 0:i.button)||{};e.confirmButton=f(f({},e.confirmButton),{},{jumpInfo:o.jumpInfo,reportId:o.reportId,title:o.title}),e.M_serviceSearchGo(e.confirmButton),setTimeout((function(){e.M_clickReport({clickContent:e.confirmButton.title||""},e.confirmButton)}))}else e.$store.commit("updateDialog",{confirm:"确定",cancel:!1,title:t.errMsg||"请求超时，请稍后再试"})})))}}}},m=(i(780),i(4)),d=Object(m.a)(p,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"smart-volunteer"},[t.itemInfo.titleInfo?i("div",{staticClass:"title-wrap",attrs:{role:"option"}},[i("span",{domProps:{innerHTML:t._s(t.xss(t.itemInfo.titleInfo.title))}}),i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"icon-wrap active__opacity",attrs:{"data-report-id":t.M_itemReportId(t.itemInfo.titleInfo.reportId)},on:{click:function(e){return e.stopPropagation(),t.onTapTitleIcon(t.itemInfo.titleInfo)}}},[i("svg-icon",{staticClass:"icon-info",attrs:{name:"info"}})],1)]):t._e(),t.formList&&t.formList.length?i("form",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"form-list",attrs:{action:"#"},on:{submit:function(e){return e.preventDefault(),t.onTapConfirm(t.confirmButton)},click:function(t){t.stopPropagation()}}},t._l(t.formList,(function(e,o){return i("div",{key:e.label,staticClass:"form-item",attrs:{role:"button","data-report-id":t.M_itemReportId(e.reportId,"0:list|"+(o+1))}},[i("p",{staticClass:"form-item-label",domProps:{innerHTML:t._s(t.xss(e.label))}}),i("div",{staticClass:"form-item-line"}),e.input?i("input",{staticClass:"weui-input",attrs:{type:"text",placeholder:e.selector.placeholder||""},domProps:{value:e.selector.value||""},on:{input:function(i){return t.onInput(i,e)},focus:function(i){return t.onFocus(i,e)}}}):e.location?i("poi",{attrs:{"default-slot":"",source:{location:e.location}},on:{"source:city-clicked":function(i){return t.onCityClicked(e)},"source:city-changed":function(i){return t.onCityChanged(i,e)}}},[i("p",{staticClass:"form-item-cont",class:{placeholder:!e.selector.value&&e.selector.placeholder}},[t._v(t._s(e.selector.value||e.selector.placeholder||""))]),e.showArrow?i("ui-arrow",{attrs:{align:"flex",gap:12,direction:"down",size:"big"}}):t._e()],1):i("div",{staticClass:"form-action",on:{click:function(i){return i.stopPropagation(),t.onClickSelector(e)}}},[i("p",{staticClass:"form-item-cont",class:{placeholder:!e.selector.value&&e.selector.placeholder}},[t._v(t._s(e.selector.value||e.selector.placeholder||""))]),e.showArrow?i("ui-arrow",{attrs:{align:"flex",gap:12,direction:"down",size:"big"}}):t._e()],1)],1)})),0):t._e(),t.confirmButton?i("ui-button",{staticClass:"confirm",attrs:{type:1,title:t.confirmButton.title,loading:t.btnLoading,"data-report-id":t.M_itemReportId(t.confirmButton.reportId)},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapConfirm(t.confirmButton)}}}):t._e()],1)}),[],!1,null,"34763bb7",null);e.default=d.exports},693:function(t,e,i){},780:function(t,e,i){"use strict";i(693)}}]);