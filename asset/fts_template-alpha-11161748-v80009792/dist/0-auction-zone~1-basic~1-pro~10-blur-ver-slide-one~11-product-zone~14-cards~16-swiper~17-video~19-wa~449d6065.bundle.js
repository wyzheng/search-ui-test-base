(window.webpackJsonp=window.webpackJsonp||[]).push([[278],{1564:function(t,e,i){"use strict";i(943)},1566:function(t,e,i){"use strict";i(945)},1567:function(t,e,i){"use strict";i(946)},1568:function(t,e,i){"use strict";i(947)},1720:function(t,e,i){"use strict";i(887)},504:function(t,e,i){"use strict";var n=i(92),a=i.n(n),o=i(0),r=i(17),s=i(14),l={mixins:[o.m,o.k],props:{poster:{type:String,default:""},controls:{type:Array,default:function(){return[]}},aspectRatio:{type:Number,default:0},innerAspectRatio:{type:Number,default:0},soundControlPositionRelativeToTopRight:{type:Number,default:12},fitMode:{type:String,default:"cover"},roundCorner:{type:Boolean,default:!1},roundCornerTopLeft:{type:Boolean,default:!1},roundCornerTopRight:{type:Boolean,default:!1},roundCornerBottomLeft:{type:Boolean,default:!1},roundCornerBottomRight:{type:Boolean,default:!1},playControlSize:{type:Number,default:40},roundCornerSize:{type:Number,default:4},isSoundControlInteractive:{type:Boolean,default:!0},isPlaying:{type:Boolean,default:!1},isMuted:{type:Boolean,default:!0},data:{type:Object,default:function(){return{}}},item:{type:Object,default:function(){return{}}},typePos:{type:Number,default:0},pos:{type:Number,default:0},videoId:{type:String,default:""}},data:function(){return{canvasTimer:null}},computed:{feedId:function(){if(this.videoId)return this.videoId;if(this.item.jumpInfo&&this.item.jumpInfo.feedId)return this.item.jumpInfo.feedId;var t={};try{t=JSON.parse(this.item.jumpInfo.extInfo)}catch(t){}return t.finderUserName||"静音"},muteReportId:function(){return"".concat(this.feedId,":mute:").concat(s.a.getRandom(6))},phonicReportId:function(){return"".concat(this.feedId,":phonic:").concat(s.a.getRandom(6))},showPlayControl:function(){return!this.isPlaying&&this.controls.indexOf("play")>=0},showSoundControl:function(){return this.isPlaying&&this.controls.indexOf("sound")>=0},videoPlayerStyle:function(){var t={};return this.aspectRatio>0?Object.assign(t,{width:"100%",paddingBottom:"".concat(100*this.aspectRatio,"%")}):Object.assign(t,{width:"100%",height:"100%"}),this.roundCorner?Object.assign(t,{borderRadius:"".concat(this.roundCornerSize,"px")}):(this.roundCornerTopLeft||this.roundCornerTopRight||this.roundCornerBottomLeft||this.roundCornerBottomRight)&&Object.assign(t,{borderTopLeftRadius:this.roundCornerTopLeft?"".concat(this.roundCornerSize,"px"):"0",borderTopRightRadius:this.roundCornerTopRight?"".concat(this.roundCornerSize,"px"):"0",borderBottomLeftRadius:this.roundCornerBottomLeft?"".concat(this.roundCornerSize,"px"):"0",borderBottomRightRadius:this.roundCornerBottomRight?"".concat(this.roundCornerSize,"px"):"0"}),t},showVideoPlayerBlurBg:function(){return this.innerAspectRatio>0&&Math.abs(this.aspectRatio-this.innerAspectRatio)>.01},videoPlayerBdStyle:function(){var t={};if(this.showVideoPlayerBlurBg){var e=this.aspectRatio||1;if(this.innerAspectRatio>e){var i=e/this.innerAspectRatio;Object.assign(t,{top:0,bottom:0,width:"".concat((100*i).toFixed(2),"%"),left:"".concat((100*(1-i)/2).toFixed(2),"%")})}else if(this.innerAspectRatio<e){var n=this.innerAspectRatio/e;Object.assign(t,{left:0,right:0,height:"".concat((100*n).toFixed(2),"%"),top:"".concat((100*(1-n)/2).toFixed(2),"%")})}}else Object.assign(t,{backgroundSize:this.fitMode.startsWith("auto-")?"100% auto":this.fitMode});return this.roundCorner?Object.assign(t,{borderRadius:"".concat(this.roundCornerSize,"px")}):(this.roundCornerTopLeft||this.roundCornerTopRight||this.roundCornerBottomLeft||this.roundCornerBottomRight)&&Object.assign(t,{borderTopLeftRadius:this.roundCornerTopLeft?"".concat(this.roundCornerSize,"px"):"0",borderTopRightRadius:this.roundCornerTopRight?"".concat(this.roundCornerSize,"px"):"0",borderBottomLeftRadius:this.roundCornerBottomLeft?"".concat(this.roundCornerSize,"px"):"0",borderBottomRightRadius:this.roundCornerBottomRight?"".concat(this.roundCornerSize,"px"):"0"}),t},playControlStyle:function(){return{width:"".concat(this.playControlSize,"px"),height:"".concat(this.playControlSize,"px")}},soundControlStyle:function(){return{top:"".concat(this.soundControlPositionRelativeToTopRight,"px"),right:"".concat(this.soundControlPositionRelativeToTopRight,"px")}},cornerStyle:function(){return{width:"".concat(this.roundCornerSize,"px"),height:"".concat(this.roundCornerSize,"px")}}},methods:{onClickPlayControl:function(t){this.$emit("tap:play",t)},onClickSoundControl:function(t){var e=this.isMuted?this.muteReportId:this.phonicReportId;this.$emit("tap:sound",t,this.isMuted,e,this.M_getItemPos(e))},startCanvasTimer:function(t){var e=this,i=this.$refs,n=i.blurBgCanvasContainer,a=i.blurBgCanvas;Global.os.ios&&parseInt(o.b.os.version)<14||!this.canvasTimer&&t&&a&&n&&(this.canvasTimer=setInterval((function(){var i=e.$refs,n=i.blurBgCanvasContainer,a=i.blurBgCanvas;if(a&&n){var o=n.getBoundingClientRect(),r=o.width,s=o.height;a.width=r,a.height=s;var l=a.getContext("2d");if(l){l.clearRect(0,0,a.width,a.height);var d=a.width,u=a.height,c=t.videoWidth,p=t.videoHeight,h=c*u/d,m=p*d/u;h<=p?l.drawImage(t,0,(p-h)/2,c,h,0,0,d,u):m<=c&&l.drawImage(t,(c-m)/2,0,m,p,0,0,d,u)}}}),100))},stopCanvasTimer:function(){if(this.canvasTimer){clearInterval(this.canvasTimer),this.canvasTimer=null;var t=this.$refs.blurBgCanvas;if(t){var e=t.getContext("2d");e&&e.clearRect(0,0,t.width,t.height)}}}}},d=(i(1564),i(4)),u=Object(d.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-player",style:t.videoPlayerStyle},[t.showVideoPlayerBlurBg?i("div",{directives:[{name:"image",rawName:"v-image:color",value:t.poster,expression:"poster",arg:"color"}],ref:"blurBgCanvasContainer",staticClass:"video-player__blur-bg"},[i("canvas",{ref:"blurBgCanvas",staticClass:"video-player__blur-bg-canvas"})]):t._e(),i("div",{directives:[{name:"image",rawName:"v-image:color",value:t.poster,expression:"poster",arg:"color"}],staticClass:"video-player__bd",style:t.videoPlayerBdStyle},[t._t("media")],2),i("div",{staticClass:"video-player__slot"},[t._t("default",null,{type:"static"})],2),i("div",{staticClass:"video-player__corners"},[t.roundCorner||t.roundCornerTopLeft?i("svg-icon",{staticClass:"corner corner_top-left",style:t.cornerStyle,attrs:{"aria-hidden":"true",name:"border-radius"}}):t._e(),t.roundCorner||t.roundCornerTopRight?i("svg-icon",{staticClass:"corner corner_top-right",style:t.cornerStyle,attrs:{"aria-hidden":"true",name:"border-radius"}}):t._e(),t.roundCorner||t.roundCornerBottomLeft?i("svg-icon",{staticClass:"corner corner_bottom-left",style:t.cornerStyle,attrs:{"aria-hidden":"true",name:"border-radius"}}):t._e(),t.roundCorner||t.roundCornerBottomRight?i("svg-icon",{staticClass:"corner corner_bottom-right",style:t.cornerStyle,attrs:{"aria-hidden":"true",name:"border-radius"}}):t._e()],1),i("div",{staticClass:"video-player__controls"},[t.showPlayControl?i("ui-icon",{staticClass:"control_play",style:t.playControlStyle,attrs:{name:"play-o",role:"button","aria-label":"播放"},nativeOn:{click:function(e){return t.onClickPlayControl.apply(null,arguments)}}}):t._e(),t.showSoundControl?i("div",[t.isMuted?i("div",{directives:[{name:"active",rawName:"v-active.stop",value:t.isSoundControlInteractive,expression:"isSoundControlInteractive",modifiers:{stop:!0}}],staticClass:"control_sound active__opacity",style:t.soundControlStyle,attrs:{role:"button","aria-label":"打开声音","data-report-id":t.M_itemReportId(t.muteReportId)},on:{click:t.onClickSoundControl}},[i("svg-icon",{staticClass:"control_mute",attrs:{name:"mute"}})],1):i("div",{directives:[{name:"active",rawName:"v-active.stop",value:t.isSoundControlInteractive,expression:"isSoundControlInteractive",modifiers:{stop:!0}}],staticClass:"control_sound active__opacity",style:t.soundControlStyle,attrs:{role:"button","aria-label":"关闭声音","data-report-id":t.M_itemReportId(t.phonicReportId)},on:{click:t.onClickSoundControl}},[i("svg-icon",{staticClass:"control_unmute",attrs:{name:"unmute"}})],1)]):t._e()],1)])}),[],!1,null,"6f5f00ae",null).exports,c={components:{StaticVideoPlayer:u},inject:{registerVideoPlayer:{default:function(){return function(){}}},unregisterVideoPlayer:{default:function(){return function(){}}},updateGlobalMuteState:{default:function(){return function(){}}},markComponentTemporaryIdle:{default:function(){return function(){}}}},props:{src:{type:String},poster:{type:String,default:""},autoplay:{type:Boolean,default:!1},isPlayControlInteractive:{type:Boolean,default:!1},isSoundControlInteractive:{type:Boolean,default:!0},lazyInit:{type:Boolean,default:!0},destroyIdle:{type:Boolean,default:!1},intersectionThreshold:{type:Number,default:.7},intersectionThresholdPlaying:{type:Number,default:0},intersectionThresholdPausing:{type:Number,default:0},triggerPlayOnce:{type:Boolean,default:!1},groupKey:{type:String,default:""},playSuccessivelyInGroup:{type:Boolean,default:!1},fitMode:{type:String,default:"cover"},initMuted:{type:Boolean,default:!0}},data:function(){return{canPlay:!1,isPlaying:!1,isPlayingBefore:!1,isMuted:this.initMuted,followGlobalMuteState:this.initMuted,hasBeenInited:!1,latestPlaybackPosition:0,triggerPlayTimestamp:0,hasBeenPlayed:!1,hasTimeUpdated:!1,latestTimestampUpdating:0,accumulativePlayingTime:0,accumulativePlayingTimeWithSound:0,showVideoManual:!0}},computed:{showVideo:function(){return this.lazyInit?!!this.src&&this.hasBeenInited:!!this.src||!0},keepIdle:function(){return!(this.isPlaying||!this.hasBeenPlayed||!this.triggerPlayOnce)},objectFit:function(){return this.fitMode.replace(/^auto-/,"")}},watch:{src:function(){this.isPlaying&&this.playImpl()}},created:function(){this.invokeMethod=o.g.debounce((function(t){if("play"===t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];this.play.apply(this,i)}else"pause"===t&&this.pause()}),300),this.heartbeatStat=o.g.throttle((function(t,e){this.$emit("stat:accumulativeplayingtime",t,e)}),500)},activated:function(){this.activatedHandler()},deactivated:function(){this.deactivatedHandler()},mounted:function(){var t=this;this.registerVideoPlayer(this),this.$nextTick((function(){r.b.onWebviewResume(t.activatedHandler),r.b.onWebviewPause(t.deactivatedHandler),t.autoplay?t.play():t.lazyInit||t.initIfNotExist()}))},beforeDestroy:function(){r.b.offWebviewResume(this.activatedHandler),r.b.offWebviewPause(this.deactivatedHandler),this.unregisterVideoPlayer(this),this.pause()},methods:{handleVideoEvent:function(t){var e,i=+Date.now();"triggerplay"===t&&(this.triggerPlayTimestamp=i);for(var n=i-this.triggerPlayTimestamp,a=arguments.length,o=new Array(a>1?a-1:0),r=1;r<a;r++)o[r-1]=arguments[r];(e=console).log.apply(e,["[video] ".concat(t,": ").concat(this.src," after ").concat(n," in ").concat(i)].concat(o)),this.$emit.apply(this,["video:".concat(t),i,n].concat(o)),this.$emit.apply(this,["video:event",t,i,n].concat(o))},statVideoAccumulativePlayingTime:function(){if(this.latestTimestampUpdating>0){var t=+Date.now()-this.latestTimestampUpdating;this.accumulativePlayingTime+=t,this.isMuted||(this.accumulativePlayingTimeWithSound+=t)}this.latestTimestampUpdating=+Date.now(),this.heartbeatStat(this.accumulativePlayingTime,this.accumulativePlayingTimeWithSound)},initIfNotExist:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.hasBeenInited?this.$refs.video&&e(this.$refs.video):(this.hasBeenInited=!0,this.$nextTick((function(){var i=t.$refs.video;i?(i.addEventListener("loadedmetadata",(function(){t.handleVideoEvent("loadedmetadata",Math.round(1e3*i.duration))})),i.addEventListener("waiting",(function(){t.handleVideoEvent("waiting")})),i.addEventListener("suspend",(function(){t.handleVideoEvent("suspend")})),i.addEventListener("abort",(function(){t.handleVideoEvent("abort")})),i.addEventListener("canplay",(function(){t.handleVideoEvent("canplay")})),i.addEventListener("canplaythrough",(function(){t.handleVideoEvent("canplaythrough")})),i.addEventListener("emptied",(function(){t.handleVideoEvent("emptied")})),i.addEventListener("loadeddata",(function(){t.handleVideoEvent("loadeddata")})),i.addEventListener("stalled",(function(){t.handleVideoEvent("stalled")})),i.addEventListener("error",(function(){t.handleVideoEvent("error")})),i.addEventListener("ended",(function(){t.handleVideoEvent("ended"),t.playSuccessivelyInGroup?(t.pause(),t.showVideoManual=!1,t.markComponentTemporaryIdle(t)):t.playImpl()})),i.addEventListener("timeupdate",(function(){t.hasTimeUpdated||(t.canPlay||(t.canPlay=!0),t.hasTimeUpdated=!0,t.handleVideoEvent("timeupdateforthefirsttime")),t.handleVideoEvent("timeupdate",Math.round(1e3*i.currentTime)),t.statVideoAccumulativePlayingTime(),t.startCanvasTimer(i)})),e(i)):t.hasBeenInited=!1})))},play:function(t){this.showVideoManual=!0,this.isPlaying?this.updateLocalMuteState(t):(this.handleVideoEvent("triggerplay",this.hasBeenPlayed),this.hasTimeUpdated=!1,this.playImpl(t))},playImpl:function(t){var e=this;this.initIfNotExist((function(i){i.src!==e.src&&(e.src?(i.src=e.src,i.load()):(i.removeAttribute("src"),i.load())),e.hasBeenPlayed||(e.hasBeenPlayed=!0),e.isPlaying=!0,e.updateLocalMuteState(t),e.src?i.play().then((function(){e.handleVideoEvent("triggerplaysucc")})).catch((function(t){e.handleVideoEvent("triggerplayfail",t)})):e.handleVideoEvent("emptysrcwhileplaying")}))},pause:function(){this.stopCanvasTimer(),this.isPlaying&&(this.latestTimestampUpdating=0,this.heartbeatStat(this.accumulativePlayingTime,this.accumulativePlayingTimeWithSound),this.pauseImpl())},pauseImpl:function(){var t=this.$refs.video;t&&(t.pause(),this.latestPlaybackPosition=t.currentTime,this.handleVideoEvent("triggerpause",Math.round(1e3*this.latestPlaybackPosition)),this.destroyIdle&&(t.removeAttribute("src"),t.load())),this.isPlaying=!1},reset:function(){this.$refs.video&&(this.pause(),this.$refs.video.currentTime=0,this.latestPlaybackPosition=0)},mute:function(){this.$refs.video&&(this.$refs.video.muted=!0,this.isMuted=!0)},unmute:function(){this.$refs.video&&(this.$refs.video.muted=!1,this.isMuted=!1)},updateLocalMuteState:function(t){"boolean"==typeof t&&(this.followGlobalMuteState||(t=this.isMuted),t?this.mute():this.unmute())},onTapPlay:function(t){this.isPlayControlInteractive&&this.play(),this.$emit("tap:play",t)},onTapSound:function(t,e,i,n){this.isSoundControlInteractive&&(this.isMuted?this.unmute():this.mute(),this.updateGlobalMuteState(this.isMuted)),this.$emit("tap:sound",t,e,i,n)},deactivatedHandler:function(){this.isPlayingBefore=this.isPlaying,this.isPlaying&&this.pause()},activatedHandler:function(){this.isPlayingBefore&&this.play()},startCanvasTimer:function(t){var e=this.$refs.staticVideoPlayer;e&&"function"==typeof e.startCanvasTimer&&e.startCanvasTimer(t)},stopCanvasTimer:function(){var t=this.$refs.staticVideoPlayer;t&&"function"==typeof t.stopCanvasTimer&&t.stopCanvasTimer()}}},p=(i(1720),Object(d.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("static-video-player",t._b({ref:"staticVideoPlayer",attrs:{"is-playing":t.isPlaying,"is-muted":t.isMuted},on:{"tap:play":t.onTapPlay,"tap:sound":t.onTapSound},scopedSlots:t._u([{key:"media",fn:function(){return[t.showVideo?i("video",{ref:"video",staticClass:"video-player__media",class:{visible:t.canPlay&&t.showVideoManual},style:{objectFit:t.objectFit},attrs:{"webkit-playsinline":"",playsinline:"",crossOrigin:"anonymous"},domProps:{muted:t.initMuted}}):t._e()]},proxy:!0},{key:"default",fn:function(){return[t._t("default",null,{type:"normal"})]},proxy:!0}],null,!0)},"static-video-player",Object.assign({},t.$props,t.$attrs),!1))}),[],!1,null,"7c727d4e",null).exports),h=new Map,m={components:{NormalVideoPlayer:p},props:{exportId:{type:String,default:""},nonceId:{type:String,default:""},liveStreamUrlLazyFetch:{type:Boolean,default:!1}},data:function(){return{liveVideoSrc:"",updateLiveVideoSrcHandler:o.g.debounce(this.updateLiveVideoSrc,100)}},watch:{exportId:{handler:function(){this.liveVideoSrc=""},immediate:!0},nonceId:{handler:function(){this.liveVideoSrc=""},immediate:!0}},methods:{updateLiveVideoSrc:function(){var t=this,e=+Date.now();this.$emit("live:geturlstart"),function(t,e){if(!t||!e)return Promise.resolve("");var i="".concat(t,"-").concat(e);return h.get(i)?Promise.resolve(h.get(i)):o.h.getFinderLivePreviewUrl({encryptedId:t,nonceId:e,scene:114}).then((function(t){return h.set(i,t),t})).catch((function(){return""}))}(this.exportId,this.nonceId).then((function(i){t.liveVideoSrc=i,i?t.$emit("live:geturlsucc",+Date.now()-e):t.$emit("live:geturlfail",+Date.now()-e)}))},handleEmptySrcWhilePlaying:function(){this.updateLiveVideoSrc();for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.$emit.apply(this,["video:emptysrcwhileplaying"].concat(e))}}},f=Object(d.a)(m,(function(){var t=this.$createElement;return(this._self._c||t)("normal-video-player",this._g(this._b({attrs:{"lazy-init":!1,"destroy-idle":!0,src:this.liveVideoSrc},on:{"video:emptysrcwhileplaying":this.handleEmptySrcWhilePlaying}},"normal-video-player",this.$attrs,!1),this.$listeners),[this._t("default",null,{type:"live"})],2)}),[],!1,null,null,null).exports,v={props:{poster:{type:String,default:""},text:{type:String,default:"直播已结束"}}},y=(i(1566),Object(d.a)(v,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"video-player-mask_live-end"},[e("div",{directives:[{name:"image",rawName:"v-image:color",value:this.poster,expression:"poster",arg:"color"}],staticClass:"video-player-mask__bg"}),e("div",{staticClass:"video-player-mask__bd"},[e("ui-image",{staticClass:"video-player-mask__icon",attrs:{url:"https://res.wx.qq.com/a/fed_upload/4e09c767-7238-4dab-bb48-8da245eeb470/live_icon.svg",size:20}}),e("div",{staticClass:"video-player-mask__text"},[this._v(this._s(this.text))])],1)])}),[],!1,null,"1b5b9f7a",null).exports),g={props:{tag:{type:Object,default:function(){return{}}},leftBottomText:{type:String,default:""},likeNum:{type:[Number,String],default:""},watchNum:{type:[Number,String],default:""},duration:{type:String,default:""},durationInSeconds:{type:Number,default:0},trending:{type:Boolean,default:!1},maskBottomShadow:{type:Boolean,default:!1},isHot:{type:Boolean,default:!1}},computed:{showMaskBottomShadow:function(){return this.maskBottomShadow&&(!!this.leftBottomText||!!this.likeNum||!!this.watchNum||!!this.duration||!!this.durationInSeconds)}}},C=(i(1567),Object(d.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-player-mask"},[t.tag.title?i("ui-tag",{staticClass:"video-player-mask__tag_left-top",attrs:{title:t.tag.title,type:t.tag.type}}):t._e(),i("div",{class:{"video-player-mask__bottom":!0,"video-player-mask__bottom--shadow":t.showMaskBottomShadow}},[i("div",{staticClass:"video-player-mask__bottom-left"},[t.leftBottomText?i("div",{staticClass:"video-player-mask__text"},[t._v("\n        "+t._s(t.leftBottomText)+"\n      ")]):t._e()]),i("div",{staticClass:"video-player-mask__bottom-middle"}),i("div",{staticClass:"video-player-mask__bottom-right"},[t.watchNum?i("div",{staticClass:"video-player-mask__mark"},[i("svg-icon",{attrs:{"class-name":"video-player-mask__mark__icon",name:"watch"}}),i("div",[t._v(t._s(t.watchNum))]),t.trending?i("svg-icon",{attrs:{"class-name":"video-player-mask__mark__icon_trending",name:"top"}}):t._e()],1):t.likeNum?i("div",{staticClass:"video-player-mask__mark"},[t.isHot?i("svg-icon",{attrs:{"class-name":"video-player-mask__mark__icon",name:"fire"}}):i("svg-icon",{attrs:{"class-name":"video-player-mask__mark__icon",name:"like_outlined_medium"}}),i("div",[t._v(t._s(t.likeNum))]),t.trending?i("svg-icon",{attrs:{"class-name":"video-player-mask__mark__icon_trending",name:"top"}}):t._e()],1):t.duration||t.durationInSeconds?i("div",{staticClass:"video-player-mask__mark"},[t.duration?i("div",[t._v(t._s(t.duration))]):i("div",[t._v(t._s(t._f("mmss")(1e3*t.durationInSeconds)))]),t.trending?i("svg-icon",{attrs:{"class-name":"video-player-mask__mark__icon_trending",name:"top"}}):t._e()],1):t._e()])])],1)}),[],!1,null,"5351c075",null).exports),b=(i(15),i(29)),S=i(11),_=i(2),T=["eventName"],I={components:{VideoPlayerMaskLiveEnd:y,VideoPlayerMaskNormal:C},mixins:[o.k,o.m],props:{src:{type:String,default:""},poster:{type:String,default:""},exportId:{type:String,default:""},nonceId:{type:String,default:""},pollingCgi:{type:Object,default:function(){return{}}},static:{type:Boolean,default:!1},liveStream:{type:Boolean,default:!1},liveStreamEnded:{type:Boolean,default:!1},liveStreamEndedText:{type:String,default:""},tag:{type:Object,default:function(){return{}}},leftBottomText:{type:String,default:""},likeNum:{type:[Number,String],default:""},watchNum:{type:[Number,String],default:""},duration:{type:String,default:""},durationInSeconds:{type:Number,default:0},durationAtLeftBottom:{type:String,default:""},trending:{type:Boolean,default:!1},isHot:{type:Boolean,default:!1},maskBottomShadow:{type:Boolean,default:!1},isPlayControlInteractive:{type:Boolean,default:!1},isSoundControlInteractive:{type:Boolean,default:!0},monitorPlayControlInteraction:{type:Boolean,default:!1},monitorSoundControlInteraction:{type:Boolean,default:!1},initMuted:{type:Boolean,default:!0},data:{type:Object,default:function(){return{}}},item:{type:Object,default:function(){return{}}},typePos:{type:Number,default:0},pos:{type:Number,default:0},reportItem:{type:Object,default:function(){return{}}}},data:function(){return{pollingLiveStreamEnded:!1,currentTime:0,firstTimeUpdateInterval:0,totalTime:0}},computed:{renderComponent:function(){return this.static?u:this.isLiveStream?this.isLiveStreamEnded?u:f:this.src?p:u},isLiveStream:function(){return this.liveStream||!!this.exportId&&!!this.nonceId},isLiveStreamEnded:function(){return this.liveStreamEnded||this.pollingLiveStreamEnded},businessType:function(){var t=this.M_safeGetServiceItemCtx();return t.data&&(t.data.real_type||t.data.type)},businessSubType:function(){var t=this.M_safeGetServiceItemCtx();return t.data&&t.data.subType},businessDocId:function(){var t=this.M_safeGetServiceItemCtx();return t.item&&t.item.docID},countDownStr:function(){if(this.totalTime&&this.totalTime>this.currentTime){var t=function(t){return t>=10?"".concat(t):"0".concat(t)},e=(this.totalTime-this.currentTime)/1e3,i=Math.floor(e/60),n=Math.floor(e%60);return"".concat(t(i),":").concat(t(n))}return this.durationAtLeftBottom}},watch:{pollingCgi:{handler:function(){this.updatePollingCgiLogic()},immediate:!0}},created:function(){this.eventQueue=[],this.statVideoAccumulativePlayingTime=o.g.throttle((function(t,e){var i,n;this.$emit("stat:accumulativeplayingtime",t,e),this.businessType&&o.f.reportCommonKv(b.a.videoBusiness,[o.b.searchId,o.b.sessionId,S.a.state.result.requestId||S.a.state.result.previousRid,o.b.type,o.b.parentSearchID,o.b.isHomePage,o.b.scene,"",o.b.netType,this.businessType||0,this.businessSubType||0,this.businessDocId||"",this.pos||0,+Date.now(),this.firstTimeUpdateInterval,this.totalTime,t,e,(null===(i=this.item)||void 0===i||null===(n=i.jumpInfo)||void 0===n?void 0:n.feedId)||"",this.pos])}),1e3)},destroyed:function(){this.clearPollingCgiTimer(),this.eventQueue.splice()},methods:{clearPollingCgiTimer:function(){this.pollingCgiTimer&&clearInterval(this.pollingCgiTimer)&&(this.pollingCgiTimer=null)},updatePollingCgiLogic:function(){var t=this;this.clearPollingCgiTimer(),this.isLiveStream&&this.pollingCgi&&this.pollingCgi.name&&(this.pollingCgiTimer=setInterval((function(){o.h.getCommonCgiData({cgiName:t.pollingCgi.name,data:t.pollingCgi.params}).then((function(e){e&&e.data&&0==e.data.liveStatus&&(t.pollingLiveStreamEnded=!0,t.clearPollingCgiTimer())}))}),Math.max(this.pollingCgi.interval||2e4,4e3)))},onTapPlay:function(t){(this.isPlayControlInteractive||this.monitorPlayControlInteraction)&&t.stopPropagation(),this.monitorPlayControlInteraction&&this.$emit("tap:play")},onTapSound:function(t,e,i,n){(this.isSoundControlInteractive||this.monitorSoundControlInteraction)&&t.stopPropagation(),this.monitorSoundControlInteraction&&this.$emit("tap:sound",e);var a=this.M_safeGetServiceItemCtx();this.businessType&&this.M_clickReport({pageNo:a.item.vuePage||a.data.vuePage,businessType:this.businessType,resultSubType:this.businessSubType,title:a.item.title,jumpUrl:a.item.jumpUrl||"",docId:a.item.docID||"",boxId:a.data.boxID,pos:a.pos||0,docPos:a.pos||0,typePos:a.typePos||0,sceneActionType:o.b.sceneActionType,resultType:a.data.resultType,requestId:this.$store.state.result.previousRid,parentSearchID:o.b.parentSearchID,reqBusinessType:o.b.type,timestamp:+new Date,expand:a.item.expand||"",docCookie:a.item.docCookie||"",DocExpand:a.item.DocExpand||"",clickContent:e?"取消静音":"静音",reportItem:this.reportItem},{reportId:i,actionType:e?_.g.VIDEO_PHONIC:_.g.VIDEO_MUTE,itemPos:n})},onVideoEvent:function(t,e,i){for(var n={eventName:t,ts:e,interval:i},a=arguments.length,o=new Array(a>3?a-3:0),r=3;r<a;r++)o[r-3]=arguments[r];switch(t){case"triggerplay":var s=o[0];Object.assign(n,{hasBeenPlayed:s});break;case"triggerplayfail":var l=o[0];l&&l instanceof Error&&Object.assign(n,{error:{code:l.code,name:l.name,message:l.message}});break;case"triggerpause":var d=o[0];d>0&&Object.assign(n,{pausePosition:d});break;case"loadedmetadata":var u=o[0];u>0&&(Object.assign(n,{duration:u}),this.totalTime=u);break;case"timeupdateforthefirsttime":this.firstTimeUpdateInterval=n.interval;break;case"timeupdate":var c=o[0];c&&(this.currentTime=c)}this.eventQueue.push(n),["triggerplayfail","triggerpause"].indexOf(t)>=0&&this.reportPerformance(),this.$emit.apply(this,["video:event",t,e,i].concat(o))},onStatAccumulativePlayingTime:function(t,e){this.statVideoAccumulativePlayingTime(t,e)},reportPerformance:function(){if(!(this.eventQueue.length<=0)){var t="",e=!1,i=0,n=0,r=0;this.eventQueue.forEach((function(o){var s=o.eventName,l=a()(o,T);switch(s){case"triggerplay":e=l.hasBeenPlayed;break;case"triggerplayfail":t=l.error&&l.error.message||"";break;case"timeupdateforthefirsttime":i=l.interval;break;case"loadedmetadata":n=l.interval,r=l.duration}})),o.f.reportCommonKv(b.a.videoPerformance,[o.b.netType,this.isLiveStream?encodeURIComponent("live_".concat(this.exportId,"_").concat(this.nonceId)):encodeURIComponent(this.src),encodeURIComponent(JSON.stringify(this.eventQueue)),r||this.totalTime,encodeURIComponent(t),+e,i,n]),this.eventQueue.splice(0)}},play:function(){var t=this.$refs.componentRef;t&&"function"==typeof t.play&&t.play()},pause:function(){var t=this.$refs.componentRef;t&&"function"==typeof t.pause&&t.pause()}}},P=(i(1568),Object(d.a)(I,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(t.renderComponent,t._g(t._b({ref:"componentRef",tag:"component",on:{"tap:play":t.onTapPlay,"tap:sound":t.onTapSound,"video:event":t.onVideoEvent,"stat:accumulativeplayingtime":t.onStatAccumulativePlayingTime},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.type;return[t.isLiveStream&&t.isLiveStreamEnded?i("video-player-mask-live-end",{attrs:{poster:t.poster,text:t.liveStreamEndedText}}):i("video-player-mask-normal",{attrs:{tag:t.tag,"left-bottom-text":t.durationAtLeftBottom?t.countDownStr:t.leftBottomText,"like-num":t.likeNum,"watch-num":t.watchNum,duration:t.duration,"duration-in-seconds":t.durationInSeconds,trending:t.trending,"mask-bottom-shadow":t.maskBottomShadow,"is-hot":t.isHot}}),i("div",{staticClass:"video-player__insert-layer"},[t._t("default",null,{type:n})],2)]}}],null,!0)},"component",Object.assign({},t.$attrs,t.$props),!1),t.$listeners))}),[],!1,null,"d400cbd4",null));e.a=P.exports},887:function(t,e,i){},943:function(t,e,i){},945:function(t,e,i){},946:function(t,e,i){},947:function(t,e,i){}}]);