(window.webpackJsonp=window.webpackJsonp||[]).push([[207],{1358:function(t,e,i){},1997:function(t,e,i){"use strict";i(1358)},2317:function(t,e,i){"use strict";i.r(e);var o=i(1),a=i.n(o),n=i(0),r=i(3),s=i(8),c=i(46),u=i.n(c),l=i(14),d=i(28),f=i(791),p=i(17),h=i(632);function m(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function v(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?m(Object(i),!0).forEach((function(e){a()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var g={default:0,loading:1,success:2,fail:3},b={default:0,loading:1,playing:2},k={name:"TranslateGeneral",components:{UiDropdown:h.a},mixins:[n.k,n.m],props:{source:{type:Object,default:function(){return{}}},data:{type:Object,default:function(){return{}}},item:{type:Object,default:function(){return{}}},pos:{type:Number,default:0},typePos:{type:Number,default:0}},data:function(){var t,e,i,o,a,n,r,s,c,u,l,d,f,p,h,m,v,k;return{audioCgi:(null===(t=this.source)||void 0===t||null===(e=t.data)||void 0===e||null===(i=e.transData)||void 0===i?void 0:i.audioCgi)||null,content:(null===(o=this.source)||void 0===o||null===(a=o.data)||void 0===a||null===(n=a.transData)||void 0===n?void 0:n.word)||"",transResult:(null===(r=this.source)||void 0===r||null===(s=r.data)||void 0===s||null===(c=s.transData)||void 0===c?void 0:c.value)||"",jumpInfo:(null===(u=this.source)||void 0===u||null===(l=u.data)||void 0===l||null===(d=l.transData)||void 0===d?void 0:d.jumpInfo)||"",audioSrc:(null===(f=this.source)||void 0===f||null===(p=f.data)||void 0===p||null===(h=p.transData)||void 0===h?void 0:h.audioSrc)||"",hideAudioIcon:(null===(m=this.source)||void 0===m||null===(v=m.data)||void 0===v||null===(k=v.transData)||void 0===k?void 0:k.hide_audio_icon)||!1,PickerStatus:g,pickerStatus:g.default,AudioStatus:b,audioStatus:b.default,maxLimit:4e3,showLimit:!1,areaHeight:null,isAudioLoading:!1}},computed:{fromPicker:function(){var t=this.source.forms&&this.source.forms.filter((function(t){return"from"===t.id}));return t&&t.length?t[0]:null},toPicker:function(){var t=this.source.forms&&this.source.forms.filter((function(t){return"to"===t.id}));return t&&t.length?t[0]:null},transData:function(){return this.source.data&&this.source.data.transData||{}},forbidTansfer:function(){return"auto"==this.fromPicker.formSelector.formValue.value},limitFuncion:function(){return(1==this.transData.audio_style||2==this.transData.audio_style)&&(Global.os.ios||!1)&&!n.b.queryString.pcWhiteboardScene},forceChangeLangs:function(){return 1==this.transData.languageType}},watch:{item:function(){this.init()},content:function(t){t.length>=this.maxLimit?(this.showLimit=!0,this.transResult=""):(this.showLimit=!1,this.refreshDebounce())},transResult:function(){this.pauseHandler()}},created:function(){this.langPicker=null,this.init(),s.b.onInputChange(this.hide),s.b.onInputConfirm(this.hide),n.a.$on(r.b.REAL_SWITCH_TAB,this.hide),n.a.$on(r.b.APP_VIEW_CHANGED,this.hide)},mounted:function(){var t=this,e=this.$refs.textArea;this.areaHeight=e&&e.clientHeight,this.$nextTick((function(){p.b.onWebviewPause(t.pauseHandler)}))},methods:{onToggle:function(t,e){this.report({clickZone:f.b.fold,clickContent:e?"全部":"收起"}),t()},onTapPicker:function(t){var e=this,i=e.source.forms.indexOf(t),o=t.hint,a=t.formSelector;this.langPicker=u.a.picker(a.showList,{className:"trans-weui-picker",container:"body",depth:1,defaultValue:[a.formValue.value],title:o,confirmText:"完成",closeText:"取消",onConfirm:function(o){if(this.forceChangeLangs&&o[0].label.indexOf("中文")<0){var n={label:"中文",value:"zh-CHS"};(1==i?0:1)?e.$set(e.toPicker.formSelector,"formValue",n):e.$set(e.fromPicker.formSelector,"formValue",n)}a.formValue=o[0],e.$set(e.source.forms,i,t),e.refreshDebounce(),e.report({clickZone:i?f.b.toPicker:f.b.fromPicker,clickContent:t.formSelector.formValue.label})},id:"trans".concat(Math.random())}),this.report({clickZone:i?f.b.toPicker:f.b.fromPicker,clickContent:t.formSelector.formValue.label})},onTapTranser:function(){if(!this.forbidTansfer){this.content=this.transResult,this.transResult="";var t=this.fromPicker.formSelector.formValue,e=this.toPicker.formSelector.formValue;this.$set(this.fromPicker.formSelector,"formValue",e),this.$set(this.toPicker.formSelector,"formValue",t),this.refreshDebounce(),this.$forceUpdate(),this.report({clickZone:f.b.transfer,clickContent:""})}},refreshDebounce:l.a.vueDebounce("refresh",200),refresh:function(){var t=this;if(!this.showLimit)if(""!=this.content){this.pickerStatus=g.loading;var e={cgiName:this.source.cgi.name,data:v(v({},this.source.cgi.params),{},{from:this.fromPicker.formSelector.formValue.value,to:this.toPicker.formSelector.formValue.value,text:this.content})};n.h.getCommonCgiData(e).then((function(e){var i=e.jumpInfo,o=e.machine,a=void 0===o?{}:o;t.jumpInfo=i,t.transResult=a.trans_text,t.audioSrc=a.audioSrc||"",t.hideAudioIcon=a.hide_audio_icon||!1,t.isAudioLoading=!1;["from","to"].forEach((function(e,i){var o=t["".concat(e,"Picker")].formSelector;a[e]&&o.formValue.value!=a[e]&&o.showList.some((function(t){var i=t.value==a[e];return i&&(o.formValue=t),i})),t.$set(t.source.forms,i,t["".concat(e,"Picker")])})),t.pickerStatus=g.success}))}else this.transResult=""},init:function(){this.source.forms&&this.source.forms.forEach((function(t){t.formSelector=t.locationSelector,!t.formSelector.realAnchor&&t.formSelector.anchor?t.formSelector.formValue=t.formSelector.anchor:t.formSelector.formValue=""}))},report:function(t){this.M_clickReport(Object.assign({resultType:this.data.resultType,resultSubType:this.data.subType,pageNo:this.data.vuePage,businessType:this.data.real_type||this.data.type,docId:this.item.docID},t))},hide:function(){this.langPicker&&this.langPicker.hide()},onTapClose:function(){this.content="",this.transResult="",this.audioSrc="",this.report({clickZone:f.b.close})},onTapTransResult:function(){this.M_serviceSearchGo(this.jumpInfo),this.report({clickZone:f.b.transResult,expand:this.M_getJumpSubScene(this.jumpInfo)})},onTapAudio:function(){var t=this,e=this.$refs.audio;return this.audioStatus!=b.playing||this.limitFuncion?this.audioSrc?(this.audioStatus=b.playing,this.isAudioLoading=!0,void e.load()):(this.audioStatus=b.loading,n.h.getCommonCgiData({cgiName:this.transData.audioCgi.name,data:v(v({},this.transData.audioCgi.params),{},{text:this.transResult})}).then((function(i){if(0===i.errCode){var o=i.data,a=o.dataType,s=o.rawData,c=o.audioSrc;"1"==a?t.audioSrc="data:audio/mpeg;base64,".concat(s):"2"==a&&(t.audioSrc=c),t.isAudioLoading=!0,t.$nextTick((function(){e.load()}))}else n.a.$emit(r.b.showToast,{action:d.a.warn,text:"文本过长，暂时不可加载"}),t.pauseHandler()})),void this.report({clickZone:f.b.audio})):(this.audioStatus=b.default,void e.pause())},onAudioReady:function(){this.isAudioLoading&&(this.audioStatus=b.playing,this.$refs.audio.play())},onAudioEnd:function(){this.audioStatus=b.default},onFocus:function(){this.report({clickZone:f.b.textArea})},onInputText:function(){this.content.length>=this.maxLimit&&(this.content=this.content.substring(0,this.maxLimit))},handleCopy:function(){l.a.copyText(this.transResult).then((function(){n.a.$emit(r.b.showToast,{action:d.a.done,text:"已复制"})})).catch((function(t){})),this.report({clickZone:f.b.copy,clickContent:"复制"})},pauseHandler:function(){this.$refs.audio&&(this.audioStatus=b.default,this.$refs.audio.pause())}}},S=(i(1997),i(4)),y=Object(S.a)(k,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"translate-general"},[i("audio",{ref:"audio",attrs:{src:t.audioSrc,preload:""},on:{canplay:t.onAudioReady,ended:t.onAudioEnd}}),i("div",{staticClass:"form-box"},[i("ui-dropdown",{staticClass:"form-selector",attrs:{placeholder:t.fromPicker.hint,tabindex:"-1"},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapPicker(t.fromPicker)}}},[i("div",{staticClass:"form-selector-content"},[i("p",{staticClass:"form-selector-value"},[i("span",[t._v(t._s(t.fromPicker.formSelector.formValue.label))])]),t.pickerStatus==t.PickerStatus.loading?i("span",{staticClass:"circle-loading"}):t._e()])]),i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"icon-transfer active__opacity",class:{disable:t.forbidTansfer},attrs:{role:"button",tabindex:"-1","aria-label":"交换地区"},on:{click:function(e){return e.stopPropagation(),t.onTapTranser.apply(null,arguments)}}},[i("ui-image",{attrs:{url:"https://res.wx.qq.com/t/fed_upload/d0354a0a-8fdb-4de6-9661-000e3ad0f900/transfer.svg"}})],1),i("ui-dropdown",{staticClass:"form-selector",attrs:{placeholder:t.toPicker.hint,tabindex:"-1"},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapPicker(t.toPicker)}}},[i("div",{staticClass:"form-selector-content"},[i("p",{staticClass:"form-selector-value"},[i("span",[t._v(t._s(t.toPicker.formSelector.formValue.label))])])])])],1),i("div",{staticStyle:{position:"relative"},style:{height:t.areaHeight+"px"}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],ref:"textArea",attrs:{rows:"5",placeholder:"输入需要翻译的句子或单词。"},domProps:{value:t.content},on:{focus:t.onFocus,input:[function(e){e.target.composing||(t.content=e.target.value)},t.onInputText]}}),t.content?i("ui-image",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"icon-close active__mask",attrs:{url:"https://res.wx.qq.com/t/fed_upload/027f4151-570e-4ed1-b338-2df3fd1f3a71/clear.svg",size:20},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapClose.apply(null,arguments)}}}):t._e()],1),t.showLimit?i("p",{staticClass:"limit-tip"},[t._v("最多可输入"+t._s(t.maxLimit)+"个文字")]):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:t.content&&t.transResult,expression:"content && transResult"}]},[i("ui-clamp",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"trans-text active__mask",attrs:{autoresize:"","max-lines":6},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapTransResult.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(e){var o=e.toggle,a=e.clamped,n=e.expanded;return[i("span",{directives:[{name:"show",rawName:"v-show",value:a||n,expression:"clamped || expanded"},{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"toggle-btn active__mask",on:{click:function(e){return e.stopPropagation(),t.onToggle(o,a)}}},[i("span",[t._v(t._s(a?"全部":"收起"))]),i("ui-arrow",{attrs:{gap:"",direction:a?"down":"up"}})],1)]}}])},[t._v(t._s(t.transResult))]),i("div",{staticClass:"menu-bar"},[t.hideAudioIcon?t._e():i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"voice-icon-wrapper active__mask",attrs:{role:"button"},on:{click:function(e){return e.stopPropagation(),t.onTapAudio.apply(null,arguments)}}},[i("i",{staticClass:"voice-icon voice-once",class:{"circle-loading":t.audioStatus==t.AudioStatus.loading,playing:t.audioStatus==t.AudioStatus.playing&&!t.limitFuncion}},[i("span",{staticClass:"ui-aria-hidden"},[t._v("单次播放")])])]),t.hideAudioIcon?t._e():i("span",{staticClass:"split"}),i("span",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"copy active__mask",attrs:{role:"button"},on:{click:function(e){return e.stopPropagation(),t.handleCopy.apply(null,arguments)}}},[t._v("复制")])])],1)])}),[],!1,null,"26e353c8",null);e.default=y.exports},575:function(t,e,i){},625:function(t,e,i){"use strict";i(575)},632:function(t,e,i){"use strict";var o={name:"UiDropdown",props:{value:{type:String,default:""},placeholder:{type:String,default:""},direction:{type:String,default:"down"},role:{type:String,default:"button"}}},a=(i(625),i(4)),n=Object(a.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"ui-dropdown",attrs:{role:t.role,tabindex:"-1"}},[i("p",{staticClass:"wording",class:{placeholder:!t.value}},[t.$slots.default?[t._t("default")]:[t._v("\n      "+t._s(t.value?t.value:t.placeholder)+"\n    ")]],2),i("ui-arrow",{attrs:{direction:t.direction,align:"flex"}})],1)}),[],!1,null,"586742ec",null).exports;n.install=function(t){t.component(n.name,n)};e.a=n},791:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return n}));var o=i(10),a=new o.a({fromPicker:1,transfer:2,toPicker:3,textArea:4,close:5,fold:6,audio:7,copy:8,transResult:9}),n=new o.a({header:10,usOnce:11,usLoop:12,ukOnce:13,ukLoop:14,list:15,example:16,exampleOnce:17,inflection:18,otherWord:19,relativeWord:20,subList:30})}}]);