(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{1323:function(t,e,a){},1962:function(t,e,a){"use strict";a(1323)},2289:function(t,e,a){"use strict";a.r(e);var n,i=a(0),o=a(46),r=a.n(o),s=a(8),c=a(3),u=a(632),h={name:"ExchangeRate",components:{UiDropdown:u.a},mixins:[i.m,i.k],props:{source:{type:Object,default:function(){return{}}},data:{type:Object,default:function(){return{}}},item:{type:Object,default:function(){return{}}},pos:{type:Number,default:0},typePos:{type:Number,default:0}},data:function(){var t=this.source.exchangeItem,e=t.defaultShow;return{fromMoneyData:t.exchangeShowList.find((function(t){return t.id===e.from}))||{},fromMoneyValue:"",toMoneyData:t.exchangeShowList.find((function(t){return t.id===e.to}))||{},toMoneyValue:"",desc:this.source.desc,exchangeList:t.exchangeList&&t.exchangeList.slice()||[]}},computed:{exchangeData:function(){return this.source.exchangeItem||{}},pickerData:function(){return this.exchangeData.exchangeShowList.map((function(t){return{label:t.name,value:t.id,data:t}}))},exchangeRate:function(){var t=this.fromMoneyData.id,e=this.toMoneyData.id;if(t===e)return 1;var a=this.exchangeList.find((function(a){return a.from===t&&a.to===e}));return a?+a.exchange/1e4:0}},watch:{exchangeRate:function(){this.hasReportInput=!1,this._inputChange()}},created:function(){this.isFetching=!1,this.hasReportInput=!1,s.b.onInputChange((function(){n&&n.hide()})),s.b.onInputConfirm((function(){n&&n.hide()})),c.a.$on(c.b.BACK_BUTTON_CLICK,(function(){n&&n.hide()})),this.exchangeRate||this._fetchRateData()},methods:{_inputCheck:function(t,e){return null===t||!/[^\d\.]/.test(t)&&(!("."===t&&e.split(".").length>2)&&!(+e>=1e10))},_inputChange:function(t){var e={from:this.$refs.from,to:this.$refs.to},a=t?"to":"from",n=t?"from":"to",i=+e[a].value;if(""===e[a].value||Number.isNaN(i))return e[n].value="",this.fromMoneyValue="",void(this.toMoneyValue="");e[n].value=this._calcExchangeMoney(i,t),this["from"===a?"fromMoneyValue":"toMoneyValue"]=e[a].value,this["from"===n?"fromMoneyValue":"toMoneyValue"]=e[n].value},_calcExchangeMoney:function(t,e){return this.exchangeRate?(e?t/this.exchangeRate:t*this.exchangeRate).toFixed(2):0},_fetchRateData:function(){var t=this,e=this.exchangeData.submit&&this.exchangeData.submit.cgi,a=this.fromMoneyData.id,n=this.toMoneyData.id;e&&a!==n&&!this.isFetching&&(this.isFetching=!0,i.h.getCommonCgiData({cgiName:e.name,data:Object.assign(e.params,{from:a,to:n})}).then((function(e){if(e.errCode&&0!==e.errCode){if(!t.exchangeRate)throw new Error(e.errMsg)}else t.desc=e.desc,e.exchangeList.forEach((function(e){var a=t.exchangeList.find((function(t){return t.from===e.from&&t.to===e.to}));a?t.$set(a,"exchange",e.exchange):t.exchangeList.push(e)}))})).catch((function(e){var a=t;t.$store.commit("updateDialog",Object.assign({title:e.message,confirmCallback:function(){a.$emit("need-jump")}}))})).then((function(){t.isFetching=!1})))},_reportUserInput:function(){this.hasReportInput||(this.hasReportInput=!0,this.M_clickReport({clickZone:this.M_getClickZonePath(),clickContent:"input",expand:this.M_getJumpSubScene(this.exchangeData)}))},swap:function(){var t=this.fromMoneyData;this.fromMoneyData=this.toMoneyData,this.toMoneyData=t,this._inputChange(),this._fetchRateData(),this.M_clickReport({clickZone:this.M_getClickZonePath(),clickContent:"swap",expand:this.M_getJumpSubScene(this.exchangeData)})},generatePicker:function(t,e){var a=this;n=r.a.picker(this.pickerData,Object.assign({id:Math.random(),defaultValue:[e?this.toMoneyData.id:this.fromMoneyData.id],title:t,onConfirm:function(t){a[e?"toMoneyData":"fromMoneyData"]=t[0].data,a._inputChange(),a._fetchRateData()}}))},onClickFromRate:function(){this.generatePicker("选择基准货币")},onClickToRate:function(){this.generatePicker("选择兑换货币",!0)},onFromRateInput:function(t){var e=this.$refs.from;this._reportUserInput(),this._inputCheck(t.data,e.value)?this._inputChange():e.value=this.fromMoneyValue},onToRateInput:function(t){var e=this.$refs.to;this._reportUserInput(),this._inputCheck(t.data,e.value)?this._inputChange(!0):e.value=this.toMoneyValue}}},l=(a(1962),a(4)),f=Object(l.a)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"exchange-rate"},[a("p",{staticClass:"exchange-rate-desc"},[t._v(t._s(t.desc))]),a("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"form-area",on:{click:function(t){t.stopPropagation()}}},[a("div",{staticClass:"input-area"},[a("div",{staticClass:"dropdown-input-box"},[a("ui-dropdown",{attrs:{value:t.fromMoneyData.name},nativeOn:{click:function(e){return t.onClickFromRate.apply(null,arguments)}}}),a("label",{attrs:{for:"from"}}),a("div",{staticClass:"input-box"},[a("input",{ref:"from",staticClass:"weui-input",attrs:{id:"from",type:"text",pattern:"[0-9\\.]*",placeholder:t.exchangeData.defaultShow.fromAmount,"aria-label":t.fromMoneyData.name},on:{input:t.onFromRateInput}})])],1),a("div",{staticClass:"dropdown-input-box"},[a("ui-dropdown",{attrs:{value:t.toMoneyData.name},nativeOn:{click:function(e){return t.onClickToRate.apply(null,arguments)}}}),a("label",{attrs:{for:"to"}}),a("div",{staticClass:"input-box"},[a("input",{ref:"to",staticClass:"weui-input",attrs:{id:"to",type:"text",pattern:"[0-9\\.]*",placeholder:t._calcExchangeMoney(t.exchangeData.defaultShow.fromAmount),"aria-label":t.toMoneyData.name},on:{input:t.onToRateInput}})])],1)]),a("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"icon-wrapper active__opacity",attrs:{role:"button",tabindex:"-1","aria-label":"交换币种"},on:{click:t.swap}},[a("ui-image",{attrs:{url:"https://res.wx.qq.com/a/fed_upload/cc596973-9029-4923-a9cc-a58fa5f1a5de/swap.svg"}})],1)])])}),[],!1,null,"9aa33648",null);e.default=f.exports},575:function(t,e,a){},625:function(t,e,a){"use strict";a(575)},632:function(t,e,a){"use strict";var n={name:"UiDropdown",props:{value:{type:String,default:""},placeholder:{type:String,default:""},direction:{type:String,default:"down"},role:{type:String,default:"button"}}},i=(a(625),a(4)),o=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"ui-dropdown",attrs:{role:t.role,tabindex:"-1"}},[a("p",{staticClass:"wording",class:{placeholder:!t.value}},[t.$slots.default?[t._t("default")]:[t._v("\n      "+t._s(t.value?t.value:t.placeholder)+"\n    ")]],2),a("ui-arrow",{attrs:{direction:t.direction,align:"flex"}})],1)}),[],!1,null,"586742ec",null).exports;o.install=function(t){t.component(o.name,o)};e.a=o}}]);