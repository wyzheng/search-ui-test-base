(window.webpackJsonp=window.webpackJsonp||[]).push([[221],{1025:function(t,e,i){},1026:function(t,e,i){},1659:function(t,e,i){"use strict";i(1025)},1660:function(t,e,i){"use strict";i(1026)},2201:function(t,e,i){"use strict";i.r(e);var o=i(24),s=i.n(o),n=i(1),a=i.n(n),r=i(10),c=i(0),u=i(8),l={name:"LocationPop",props:{pop:{type:Object,default:function(){return{}}}},created:function(){var t=this;u.b.onInputChange((function(){t.hide()})),u.b.onInputConfirm((function(){t.hide()})),c.a.$on(c.j.BACK_BUTTON_CLICK,(function(){t.hide()}))},methods:{show:function(){var t;null===(t=this.$refs._rejectiveTip)||void 0===t||t.show()},hide:function(){var t;null===(t=this.$refs._rejectiveTip)||void 0===t||t.hide()},onTapSetting:function(){this.hide(),this.$emit("tap:setting")}}},p=(i(1659),i(4)),d=Object(p.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.pop?i("div",[i("ui-half-screen",{ref:"_rejectiveTip",attrs:{"class-name":"rejective-tip","can-scroll":!0,header:{close:!0},footer:{}}},[i("div",{staticClass:"pop-location-auth"},[i("ui-image",{attrs:{url:"https://res.wx.qq.com/a/fed_upload/1ca60e69-bed2-47e6-804d-4cdd6801b5cf/weui-icon-outlined-location.svg",size:40}}),t.pop.title?i("div",{staticClass:"title"},[t._v(t._s(t.pop.overSeaTitle||t.pop.title))]):t._e(),t.pop.desc?i("div",{staticClass:"desc"},[i("span",[t._v(t._s(t.pop.desc))]),t.pop.descAction?i("span",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"desc-action active__link",on:{click:function(e){return e.stopPropagation(),t.onTapSetting.apply(null,arguments)}}},[t._v(t._s(t.pop.descAction.title))]):t._e()]):t._e()],1)])],1):t._e()}),[],!1,null,"b2723cf0",null).exports,v=i(3),f=i(2);function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function _(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){a()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var m={sticky:1,sort:2},b=new r.a({first:1,rejective:2,week:3}),g=new r.a({notDetermined:0,authorized:1,systemWithoutPermission:2,sceneWithoutPermission:3,restricted:4}),y="alreadySuggestedAuth",C="locationAuthExpiredTimestamp",O={name:"Caution",components:{locationPop:d},mixins:[c.m,c.k],props:{d:{type:Object,default:function(){return{}}},typePos:{type:Number,default:0}},data:function(){return{Util:c.g,showType:m,AuthStyle:b,outlined:"https://res.wx.qq.com/a/fed_upload/1ca60e69-bed2-47e6-804d-4cdd6801b5cf/weui-icon-outlined-location.svg",filled:"https://res.wx.qq.com/t/fed_upload/3031f870-96ac-4721-ae98-dfbce92c24e1/weui-icon-filled-location.svg",isFirst:!1,isReject:!1,isOverSeaUser:!!c.b.queryString.isOverSeaUser}},computed:{item:function(){var t,e=this,i=null===(t=this.d.items)||void 0===t?void 0:t[0];if(this.isLocationBox){var o,s=null==i||null===(o=i.authStatus)||void 0===o?void 0:o.find((function(t){return t.type===e.computedShowType}));return Object.assign({},i,s,{docID:"".concat(null==i?void 0:i.docID,"-").concat(b[null==s?void 0:s.type])})}return i},pos:function(){return 1},hasTopBar:function(){var t;return null===(t=this.$store)||void 0===t?void 0:t.state.result.self.resultObj.filter},isLocationBox:function(){return 53===this.d.subType},authInfo:function(){return c.b.locationAuth},isVisible:function(){var t,e;return!this.isLocationBox||!c.b.activeCancleAuthTip&&(null===(t=this.authInfo)||void 0===t?void 0:t.isLocationAuthExptEnable)&&(null===(e=this.authInfo)||void 0===e?void 0:e.status)===g.sceneWithoutPermission},computedShowType:function(){if(this.authInfo)return this.isReject?b.rejective:this.isOverSeaUser?b.week:this.isFirst?b.first:b.week},isRejective:function(){return this.item.type===b.rejective}},created:function(){if(this.isLocationBox&&this.isVisible){c.d.getStore(y)||(this.isFirst=!0,c.d.store(y,1));var t=c.d.getStore(C);t&&Date.now()<t&&(this.isReject=!0)}},methods:{resolveClass:function(t){switch(t){case m.sticky:return"caution__sticky";case m.sort:return"caution__sort";default:return"caution__sticky"}},onTapSetting:function(t){var e,i,o=this;(null===(e=this.authInfo)||void 0===e?void 0:e.status)===g.sceneWithoutPermission?c.h.reqCapabilityAuth({capability:1,authScene:11},(function(e){e&&0===e.retCode&&(e.succeed?(c.b.setValue({locationAuth:_(_({},o.authInfo),{},{status:e.status})}),c.d.remove(C),v.a.$emit(v.b.setQuery,{page:f.f.RESULT,searchId:c.b.searchId}),o._report(t,{actionType:f.g.CONFIRM_CHANGE_CODE,clickContent:"允许"})):(o.isReject=!0,c.d.store(C,Date.now()+1728e5),o._report(t,{actionType:f.g.CANCEL_CHANGE_CODE,clickContent:"拒绝"})))})):(null===(i=this.authInfo)||void 0===i?void 0:i.status)===g.systemWithoutPermission&&c.h.openWeiXinPage({pageUrl:"search://page/jumpSystemSetting"}),this._report(t,{actionType:f.g.CLICK_SHOW_DIALOG})},onTapClose:function(t){c.b.setValue({activeCancleAuthTip:!0}),this._report(t,{actionType:f.g.CLICK_DELETE})},onTapLocationBox:function(t){if(this.isRejective){if(!this.isRejective||!this.isOverSeaUser)return;this.$refs._jectivePop.show()}else this.onTapSetting();this._report(t,{actionType:f.g.CLICK_SHOW_DIALOG})},_report:function(t,e){var i;if(t){var o=null==t||null===(i=t.currentTarget)||void 0===i?void 0:i.getAttribute("data-report-id"),n=(null==o?void 0:o.split("$$"))||[],a=s()(n,4),r=a[2],c=a[3];this.M_clickReport(Object.assign({reportId:r,itemPos:c,cardExtInfo:{isOverSeaUser:this.isOverSeaUser}},e))}}}},w=(i(1660),Object(p.a)(O,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isVisible?i("div",{staticClass:"caution",class:{"with-top-bar":t.hasTopBar}},[i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"caution__item expose_log_elem",class:[t.resolveClass(t.item.showType),{"location-auth__box":t.isLocationBox},{active__item:!t.isRejective||t.isRejective&&t.isOverSeaUser}],attrs:{"data-id":t.M_exposeId(),"data-back-report-id":t.M_docReportId()}},[t.isLocationBox&&t.item?i("div",{class:["location-auth",""+t.AuthStyle[t.item.type]],attrs:{"data-report-id":t.M_itemReportId("panel:panel:"+t.Util.getRandom())},on:{click:function(e){return e.stopPropagation(),t.onTapLocationBox.apply(null,arguments)}}},[i("div",{staticClass:"auth-left"},[i("ui-image",{staticClass:"icon",attrs:{url:t.item.type===t.AuthStyle.first?t.filled:t.outlined}}),i("div",{staticClass:"text"},[t.item.title?i("p",{staticClass:"title"},[t._v(t._s(t.isOverSeaUser&&t.item.overSeaTitle||t.item.title))]):t._e(),t.item.desc?i("p",{staticClass:"desc"},[t._v(t._s(t.item.desc))]):t._e()])],1),i("div",{staticClass:"auth-right"},[t.isRejective?t.isOverSeaUser?i("ui-arrow",{attrs:{direction:"down",align:"flex"}}):t._e():[i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"button active__mask",attrs:{role:"button","data-report-id":t.M_itemReportId("setting:setting:"+t.Util.getRandom())},on:{click:function(e){return e.stopPropagation(),t.onTapSetting.apply(null,arguments)}}},[t._v("去设置")]),i("ui-icon",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"active__mask expand-hotspot",attrs:{name:"close",role:"button","aria-label":",关闭","data-report-id":t.M_itemReportId("close:close:"+t.Util.getRandom())},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapClose.apply(null,arguments)}}})]],2)]):[i("ui-image",{staticClass:"caution__item-icon",attrs:{url:"https://res.wx.qq.com/a/fed_upload/2ca94ec4-e220-411d-950c-04f3fcb46851/icons_outlined_info.svg"}}),i("div",{staticClass:"caution__item-wording"},[t._v("\n        "+t._s(t.item.title)+"\n      ")])]],2),t.isRejective&&t.isOverSeaUser?i("locationPop",{ref:"_jectivePop",attrs:{pop:Object.assign({},t.item.pop)},on:{"tap:setting":t.onTapSetting}}):t._e()],1):t._e()}),[],!1,null,"4c8dbbc8",null));e.default=w.exports}}]);