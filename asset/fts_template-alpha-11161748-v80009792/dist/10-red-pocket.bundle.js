(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1398:function(t,e,i){},1399:function(t,e,i){},1400:function(t,e,i){},2024:function(t,e,i){"use strict";i(1398)},2025:function(t,e,i){"use strict";i(1399)},2026:function(t,e,i){"use strict";i(1400)},2220:function(t,e,i){"use strict";i.r(e);var s=i(14),a=i(0),n=i(459),r=i(8);function o(t){return 0==t?"00":t<10?"0".concat(t):t}var c={props:{startTime:{require:!0,type:Number}},data:function(){return{status:0,textArr:[]}},watch:{status:function(t){2==t&&this.$emit("start")}},mounted:function(){var t=this;this.check(),this.timer=setInterval((function(){t.check()}),1e3)},beforeDestroy:function(){clearInterval(this.timer)},methods:{check:function(){var t=this.startTime,e=s.a.getSvrTimeMs();if(!t)return this.textArr=[],void(this.status=0);if(e>=t)return this.$emit("fire"),this.textArr=[],void(this.status=0);var i=new Date(t),a=new Date(e);if(i-a>3e5){var n=new Date(a).setHours(0,0,0,0)+864e5===new Date(i).setHours(0,0,0,0),r=new Date(a).setHours(0,0,0,0)===new Date(i).setHours(0,0,0,0),c=[],u="";n?u="明天 ":r&&(u="今天 ");var p=i.getMonth()+1,d=i.getDate(),h=o(i.getHours()),m=o(i.getMinutes());return u?(c.push({text:u}),c.push({text:"".concat(h,":").concat(m),emphasis:!0})):c.push({text:"".concat(p,".").concat(d," ").concat(h,":").concat(m),emphasis:!0}),c.push({text:" 可领取"}),this.textArr=c,void(this.status=1)}var l=Math.ceil((i-a)/1e3),f=parseInt(l/60),_=l%60,T=[];f&&(T.push({text:String(f),emphasis:!0}),T.push({text:" 分 "})),T.push({text:o(_),emphasis:!0}),T.push({text:" 秒后可领取"}),this.textArr=T,this.status=2}}},u=(i(2024),i(4)),p=Object(u.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"countdown"},t._l(t.textArr,(function(e,s){return i("span",{key:e.text+s,staticClass:"text",class:{emphasis:e.emphasis}},[t._v(t._s(e.text))])})),0)}),[],!1,null,"660adba8",null).exports,d=i(28),h=i(42),m={NOTICE:1,COUNTDOWN:2,OPEN_BTN:4,SHARE_BTN:8,MORE_BTN:16,SOLDOUT:32,DROPDOWN:64,RECEIVED:128};function l(){return s.a.getSvrTimeSecs()}var f={components:{CountDown:p,HeightAnimate:h.a},mixins:[a.m,n.a],props:{data:{type:Object,default:function(){return{}}},item:{type:Object,default:function(){return{}}},pos:{type:Number,default:0},typePos:{type:Number,default:0}},data:function(){return{FLAGS:m,justOpen:!1,updateTime:l(),popData:null,bgStyle:"",mutableItem:{remainNum:void 0,hasReceived:void 0}}},computed:{tags:function(){return this.item.recommendTag||[]},nextStartTime:function(){var t=this;return(this.item.startTime||[]).find((function(e){return e>t.updateTime}))||0},nextStartTimeMs:function(){return 1e3*this.nextStartTime},lastStartTime:function(){var t=this;return(this.item.startTime||[]).slice().reverse().find((function(e){return t.updateTime>=e}))||0},lastStartTimeMs:function(){return 1e3*this.lastStartTime},remainNum:function(){return void 0===this.mutableItem.remainNum?this.item.remainNum:this.mutableItem.remainNum},hasReceived:function(){return void 0===this.mutableItem.hasReceived?this.item.hasReceived:this.mutableItem.hasReceived},status:function(){var t=0,e=0;this.item;return this.hasReceived?(t|=m.RECEIVED,this.nextStartTime||this.remainNum?t|=m.SHARE_BTN:t|=m.MORE_BTN):this.nextStartTime||this.remainNum?this.lastStartTime&&this.remainNum?t|=m.OPEN_BTN:this.nextStartTime&&this.nextStartTime-this.updateTime<=300?(t|=m.COUNTDOWN,t|=m.SHARE_BTN):(t|=m.NOTICE,this.lastStartTime&&this.updateTime-this.lastStartTime<7200?t|=m.MORE_BTN:t|=m.SHARE_BTN):(t|=m.SOLDOUT,t|=m.MORE_BTN,e=1),this.justOpen&&!e&&(t|=m.DROPDOWN,t&=~m.SHARE_BTN),t},cardType:function(){return this.item.sendType},cardSubType:function(){var t=this.status;return t&m.NOTICE&&t&m.SHARE_BTN?1:t&m.COUNTDOWN&&t&m.SHARE_BTN?2:t&m.OPEN_BTN?3:t&m.RECEIVED&&t&m.DROPDOWN?4:t&m.RECEIVED&&t&m.SHARE_BTN?5:t&m.SOLDOUT&&t&m.MORE_BTN?6:1e3+t}},watch:{status:function(){a.f.activitySlide.reportExpose({docID:this.item.docID,businessType:131072,cardType:this.cardType,cardSubType:this.cardSubType})}},created:function(){this.refreshState=this.refreshState.bind(this),a.a.$on(a.j.viewChange,this.onViewChange)},mounted:function(){var t=this;this.$nextTick((function(){if(r.b.onWebviewResume(t.refreshState),a.f.activitySlide.reportExpose({docID:t.item.docID,businessType:131072,cardType:t.cardType,cardSubType:t.cardSubType}),t.$refs.inner){var e=t.$refs.inner.getBoundingClientRect(),i=e.width,s=e.height,n=Math.floor(.375*i-.3*s);t.bgStyle={width:"".concat(i,"px"),height:"".concat(s,"px"),top:"".concat(n,"px")}}}))},beforeDestroy:function(){r.b.offWebviewResume(this.refreshState),a.a.$off(a.j.viewChange,this.onViewChange)},methods:{onTapInner:function(){var t=this.item,e=t.buttonOpen,i=t.diaLog;if(this.$refs.countDown){if(i){var s=i.title,n=i.desc,r=i.confirm;this.$store.commit("updateDialog",Object.assign({title:s,desc:n,confirm:r,cancel:!1}))}}else e&&(this.M_storeClickInfo(),this.M_go(e),this.resumeCheckFlag=!0,this.justOpen=!1);var o=this.M_clickReport({clickZone:2}).clickId;a.f.activitySlide.reportClick({docID:this.item.docID,businessType:131072,cardType:this.cardType,cardSubType:this.cardSubType,logKeyId:o}),this.$emit("tap")},onTapShareButton:function(){var t=this,e=this.item.share;this.popData={title:e.pageHead,confirm:e.pageButton,pageTitle:e.pageTitle,pageDesc:e.pageDesc,requestId:s.a.generateGuuId()},this.$nextTick((function(){t.$refs.halfScreen&&t.$refs.halfScreen.show(),a.f.result.zoneLotteryResultExpose({requestId:t.popData.requestId,docID:t.item.docID,status:6})}));var i=this.M_clickReport({clickZone:3,clickContent:"分享按钮"}).clickId;a.f.activitySlide.reportClick({docID:this.item.docID,businessType:131072,cardType:this.cardType,cardSubType:this.cardSubType,logKeyId:i}),this.$emit("tap")},onTapOpenButton:function(){var t=this.item.buttonOpen;this.M_storeClickInfo(),this.M_go(t),this.resumeCheckFlag=!0,this.justOpen=!1;var e=this.M_clickReport({clickZone:3,clickContent:"领取按钮"}).clickId;a.f.activitySlide.reportClick({docID:this.item.docID,businessType:131072,cardType:this.cardType,cardSubType:this.cardSubType,logKeyId:e}),this.$emit("tap")},onTapMoreButton:function(){var t=this.item.buttonMore;this.M_storeClickInfo(),this.M_go(t);var e=this.M_clickReport({clickZone:3,clickContent:"其他红包可领"}).clickId;a.f.activitySlide.reportClick({docID:this.item.docID,businessType:131072,cardType:this.cardType,cardSubType:this.cardSubType,logKeyId:e}),this.$emit("tap")},refreshState:function(){var t=this,e=this.item,i=e.redPacketInfoCgi,s=e.docID;i&&this.resumeCheckFlag&&(this.updateTime=l(),this.$nextTick((function(){var e=a.d.getStore("RedPocketDropdown-21")||{};(e[s]||0)<t.lastStartTime&&(t.justOpen=!0,e[s]=t.lastStartTime,a.d.store("RedPocketDropdown-21",e))})),a.h.getCommonCgiData({cgiName:i.cgiName,data:i.param}).then((function(e){var i=e.hasReceived,s=e.remainNum;t.mutableItem.hasReceived=i,t.mutableItem.remainNum=s,t.updateTime=l(),t.resumeCheckFlag=!1})))},onViewChange:function(){this.justOpen=!1},onCountDownStart:function(){this.updateTime=l()},onCountDownFire:function(){this.mutableItem.remainNum=1,this.updateTime=l()},popConfirm:function(){this.copyText(this.popData.pageTitle),a.f.result.zoneLotteryResultClick({requestId:this.popData.requestId,docID:this.item.docID,clickType:6})},dropdownConfirm:function(){this.copyText(this.item.share.pageTitle);var t=this.M_clickReport({clickZone:3,clickContent:"复制"}).clickId;a.f.activitySlide.reportClick({docID:this.item.docID,businessType:131072,cardType:this.cardType,cardSubType:this.cardSubType,logKeyId:t})},copyText:function(t){var e=this;s.a.copyText(t).then((function(){a.a.$emit(a.j.showToast,{action:d.a.done,text:"已复制"}),e.$refs.halfScreen&&e.$refs.halfScreen.hide()})).catch((function(t){}))}}},_=(i(2025),i(2026),Object(u.a)(f,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"oz__body oz__margin-dense oz__item",attrs:{"data-id":t.M_exposeId()}},[i("div",{directives:[{name:"active",rawName:"v-active"}],ref:"inner",staticClass:"red-pocket__inner",class:{"hide-bottom-corner":t.item.share&&t.status&t.FLAGS.DROPDOWN},on:{click:t.onTapInner}},[i("div",{staticClass:"red-pocket__bg"},[i("div",{staticClass:"red-pocket__bg__linear"}),i("div",{staticClass:"red-pocket__bg__radial"},[i("ui-image",{staticClass:"red-pocket__bg__inner",style:t.bgStyle,attrs:{url:t.item.backgroundUrl}})],1)]),i("div",{staticClass:"red-pocket__cover"},[i("ui-image",{attrs:{url:t.item.thumbUrl}}),i("ui-image",{staticClass:"red-pocket__open-button",attrs:{url:"https://res.wx.qq.com/a/fed_upload/fb0e1a30-f216-4f4f-a504-65c808dc4cf1/open-button.png"}})],1),i("div",{staticClass:"red-pocket__info"},[i("div",{staticClass:"red-pocket__title"},[t._v(t._s(t.item.title))]),i("div",{staticClass:"red-pocket__desc"},[t._l(t.tags,(function(t){return i("ui-tag",{key:JSON.stringify(t),attrs:{title:t.title,desc:t.desc,type:t.type,"no-bg":!0}})})),i("span",[t._v(t._s(t.item.desc))])],2),i("div",{staticClass:"red-pocket__placeholder"}),i("div",{staticClass:"red-pocket__bottom"},[i("div",{staticClass:"red-pocket__bottom__left"},[t.status&(t.FLAGS.NOTICE|t.FLAGS.COUNTDOWN)?i("count-down",{ref:"countDown",attrs:{"start-time":t.nextStartTimeMs},on:{start:t.onCountDownStart,fire:t.onCountDownFire}}):t._e(),t.item.buttonOpen&&t.status&t.FLAGS.OPEN_BTN?i("ui-button",{ref:"openButton",staticClass:"red-pocket__button",attrs:{mini:""},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapOpenButton.apply(null,arguments)}}},[t._v(t._s(t.item.buttonOpen.title))]):t._e(),t.status&t.FLAGS.RECEIVED?i("div",{staticClass:"has-received"},[t._v("\n            已领取\n          ")]):t._e(),t.status&t.FLAGS.SOLDOUT?i("div",{staticClass:"remain-empty"},[t._v("\n            已被领完\n          ")]):t._e(),t.item.buttonMore&&t.status&t.FLAGS.MORE_BTN?i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"red-pocket__more",on:{click:function(e){return e.stopPropagation(),t.onTapMoreButton.apply(null,arguments)}}},[t._v("\n            "+t._s(t.item.buttonMore.title)+"\n            "),i("ui-arrow",{attrs:{direction:"right"}})],1):t._e()],1),i("div",{staticClass:"red-pocket__bottom__right"},[t.item.share&&t.status&t.FLAGS.SHARE_BTN?i("ui-button",{staticClass:"red-pocket__button",staticStyle:{"margin-left":"12px"},attrs:{mini:""},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapShareButton.apply(null,arguments)}}},[t._v(t._s(t.item.share.buttonOut))]):t._e()],1)])])]),t.item.share&&t.status&t.FLAGS.DROPDOWN?i("height-animate",{attrs:{duration:300,"without-enter":!1,"without-leave":!0}},[i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"red-pocket__after-share"},[i("div",{staticClass:"red-pocket__after-share__title"},[t._v("\n        "+t._s(t.item.share.pageDesc)+"\n      ")]),i("div",{staticClass:"red-pocket__after-share__desc"},[t._v("\n        "+t._s(t.item.share.pageTitle)+"\n      ")]),i("a",{staticClass:"weui-btn weui-btn_primary",attrs:{role:"button"},on:{click:function(e){return e.stopPropagation(),t.dropdownConfirm.apply(null,arguments)}}},[t._v(t._s(t.item.share.pageButton))])])]):t._e(),t.popData?i("ui-half-screen",{ref:"halfScreen",attrs:{"class-name":"red-pocket__popup",header:{title:t.popData.title,close:!0},footer:{confirm:t.popData.confirm}},on:{"tap:confirm":t.popConfirm}},[i("div",{staticClass:"red-pocket__popup-share"},[i("div",{staticClass:"red-pocket__popup-share__title"},[t._v("\n        "+t._s(t.popData.pageDesc)+"\n      ")]),i("div",{staticClass:"red-pocket__popup-share__desc"},[t._v(t._s(t.popData.pageTitle))])])]):t._e()],1)}),[],!1,null,"7bcc49ea",null));e.default=_.exports},459:function(t,e,i){"use strict";var s={methods:{ozJump:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this;e.M_confirm_go(t.dialog,t)}},computed:{M_canHeaderJump:function(){return!!this.item.header&&!!(this.item.header.jumpUrl||this.item.header.weappUrl||this.item.header.jumpInfo)}}};e.a=s}}]);