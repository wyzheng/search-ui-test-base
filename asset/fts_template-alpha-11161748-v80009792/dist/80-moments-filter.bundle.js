(window.webpackJsonp=window.webpackJsonp||[]).push([[269],{1553:function(e,t,i){"use strict";i(933)},2134:function(e,t,i){"use strict";i.r(t);var n,s,r=i(33),a=i.n(r),o=i(1),l=i.n(o),c=i(23),u=i.n(c),m=i(25),p=(i(46),i(42)),h=i(815),f=i(0),d=i(16),v=i(8),y=i(2),T=i(5),b=i(3),g=i(652);function _(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var w=[-1,-1,-1],C=f.g.L("朋友"),F=f.g.L("发布时间"),D=f.g.L("内容类型"),O={components:{heightAnimate:p.a,"scroll-modal":h.a},data:function(){return{isAdvSearch:0,publishDisplayName:C,publishDisplayTime:F,publishUsername:"",isShow:!1,isTimeActived:!1,isTypeFilterActived:!1,renderOption:[],siftOptionTop:0,siftOptionLeft:0,snsContentType:[]}},computed:function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?_(Object(i),!0).forEach((function(t){l()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({isNoSelected:function(){return this.publishDisplayName==C&&this.publishDisplayTime==F},isNameSelected:function(){return this.publishDisplayName!==C},isTimeSelected:function(){return this.publishDisplayTime!==F},isSnsTypeSelected:function(){return this.moment.snsContentTypeFilter},publishDisplayType:function(){var e=this,t=this.snsContentType.find((function(t){return t.value===e.moment.snsContentTypeFilter}));return t?t.tip:D}},Object(m.c)({moment:function(e){return e.result.moment}})),watch:{$route:function(e){e.name===y.h.view.INDEX&&(this._reset(),this.isShow=!1)},isTypeFilterActived:function(e){(Global.os.ios||Global.os.android)&&(e?f.a.$emit(b.b.TAG_TOUCH_ACTION,!0):f.a.$emit(b.b.TAG_TOUCH_ACTION,!1))}},created:function(){var e=this,t=this;v.b.onSelectContact((function(e){0==e.ret?(t.publishDisplayName=e.nickname||C,t.publishUsername=e.username||"",""==e.username?t.$store.commit({type:"result/updateMoment",tagInfoFromFilter:{},matchUserFromFilter:{}}):t.$store.commit({type:"result/updateMoment",tagInfoFromFilter:{tagText:f.b.query,tagType:y.q.SNSALBUM},matchUserFromFilter:{matchWord:t.publishDisplayName,userName:t.publishUsername}}),t.onSearchTap(),f.f.result.momentFilter({reportType:2,clickType:3})):t.$store.commit({type:"result/updateMoment",tagInfoFromFilter:{},matchUserFromFilter:{}})})),f.a.$on(b.b.RESET_MOMENT_FILTER,(function(){t._reset(!0)})),v.b.onInputChange((function(){n&&n.hide(),e.typeFilterHide()})),v.b.onInputConfirm((function(){n&&n.hide(),e.typeFilterHide()})),f.a.$on(b.b.SEARCH_DATA_RENDERED,(function(i){if(f.b.type==T.c.MOMENT)if(e._checkEmtyQueryWithTag())t.isShow=!1;else{t.isAdvSearch=!f.g.isArrayLength(t.$store.state.result.moment.tagList);var n=i.resultObj;if(n.data&&n.data.length||t.publishDisplayName!=C||t.publishDisplayTime!=F||e.moment.snsContentTypeFilter?(t.isShow=!0,f.f.result.momentFilter()):t.isShow=!1,n.data&&n.data.length){var s=n.data.find((function(e){return e.type===T.c.MOMENT}));s&&s.snsContentType&&s.snsContentType.length&&(e.snsContentType=s.snsContentType)}}else t.isShow=!1})),f.a.$on(b.b.REAL_SWITCH_TAB,this.typeFilterHide),f.a.$on(b.b.APP_VIEW_CHANGED,this.typeFilterHide),f.a.$on(b.b.BACK_BUTTON_CLICK,(function(i){if(n&&n.hide(),e.typeFilterHide(),t.isAdvSearch=!f.g.isArrayLength(t.$store.state.result.moment.tagList),t.isAdvSearch){if(t.$store.commit({type:"result/updateMoment",tagInfoFromFilter:i.tagInfo,matchUserFromFilter:i.matchUser,numConditions:[],snsContentTypeFilter:i.snsContentTypeFilter}),f.g.isArrayLength(i.numConditions)){var s=i.numConditions[0],r=new Date(1e3*s.from).getFullYear();if(s.to-s.from>2678400)t.publishDisplayTime="".concat(r,"年");else if(s.to-s.from>86400){var a=new Date(1e3*s.from).getMonth();t.publishDisplayTime="".concat(r,"年").concat(a+1,"月")}else{var o=new Date(1e3*s.from).getMonth(),l=new Date(1e3*s.from).getDate();t.publishDisplayTime="".concat(r,"年").concat(o+1,"月").concat(l,"日")}}else t.publishDisplayTime=F;t.publishDisplayName=i.matchUser&&i.matchUser.matchWord?i.matchUser.matchWord:C,t.publishUsername=i.matchUser&&i.matchUser.userName?i.matchUser.userName:""}})),t._initial()},methods:{_initial:function(){s=+new Date},_reset:function(){var e=this;s=+new Date,e.$store.commit({type:"result/updateMoment",tagInfoFromFilter:{},matchUserFromFilter:{},numConditions:[],snsContentTypeFilter:""}),e.isAdvSearch=!f.g.isArrayLength(e.$store.state.result.moment.tagList),e.publishDisplayName=C,e.publishDisplayTime=F,e.publishUsername=""},_showTimePicker:function(e){var t=this;t.isTimeActived=!0,n=Object(g.a)({id:s,defaultValue:w,className:"moment-picker",pickerRef:this.$refs.Picker,onClose:function(){t.isTimeActived=!1},onConfirm:function(i){var n;if(i&&-1!=i[0].value){var s,r,a=i[0].value,o=i[1].value,l=i[2].value;-1==o?(s=new Date(a,0).getTime()/1e3,r=(new Date(a+1,0).getTime()-1)/1e3):-1==l?(s=new Date(a,o).getTime()/1e3,r=(new Date(a,o+1).getTime()-1)/1e3):(s=new Date(a,o,l).getTime()/1e3,r=(new Date(a,o,l+1).getTime()-1)/1e3),n={from:s,to:r,field:1},t.publishDisplayTime=i[0].label+(-1==i[1].value?"":i[1].label)+(-1==i[2].value?"":i[2].label)}else t.publishDisplayTime=F;n?t.$store.commit({type:"result/updateMoment",numConditions:[n]}):t.$store.commit({type:"result/updateMoment",numConditions:[]}),e&&e(i),t.isTimeActived=!1,f.f.result.momentFilter({reportType:2,clickType:4})}});var i=document.querySelector(".moment-picker");i&&i.addEventListener("touchmove",(function(e){e.stopPropagation(),e.preventDefault()}))},_checkEmtyQueryWithTag:function(){try{var e=!f.g.isArrayLength(this.$store.state.result.moment.tagList),t=1===(this.$store.state.result.moment.tagList||[]).length&&this.$store.state.result.moment.tagList[0].tagName;return!e&&f.b.query.trim()===t&&(this.isShow=!1,this._reset(),!0)}catch(e){return!1}},onContactTap:function(){this.typeFilterHide(),f.h.selectContact({selected_user_name:this.publishUsername}),Object(d.h)(f.l.feature.advMoment.tapContactSort),f.f.result.momentFilter({reportType:2,clickType:1}),Object(d.h)(f.l.feature.momentContact)},onTimeTap:function(){var e=this;return a()(u.a.mark((function t(){var i,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e,n=e.isTypeFilterActived,i.typeFilterHide(),!n){t.next=6;break}return t.next=6,new Promise((function(e){setTimeout((function(){e()}),300)}));case 6:if(!i.$store.state.result.self.base.isLoading){t.next=8;break}return t.abrupt("return");case 8:e.isAdvSearch?i._showTimePicker((function(){i.onSearchTap()})):i._showTimePicker((function(){f.a.$emit(b.b.setQuery,{})})),Object(d.h)(f.l.feature.advMoment.tapTimeSort),f.f.result.momentFilter({reportType:2,clickType:2}),Object(d.h)(f.l.feature.momentTime);case 12:case"end":return t.stop()}}),t)})))()},onSearchTap:function(){this._checkEmtyQueryWithTag()&&this._reset(),f.b.setValue({sceneActionType:y.r.NORMAL}),f.b.query&&f.a.$emit(b.b.setQuery,{}),Object(d.h)(f.l.feature.advMoment.confirmSort)},tapSift:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.snsContentType,t=this,i=t.$refs.Picker,n=i.getElementsByClassName("sift__item-i-type");if(i){var s=i.getBoundingClientRect(),r=window.pageYOffset+s.top,a=s.height;t.siftOptionTop=Math.ceil(r+a)}n&&(t.siftOptionLeft=n.offsetLeft),this.isTypeFilterActived=!this.isTypeFilterActived,this.isTypeFilterActived?(t.renderOption=e,setTimeout((function(){t.$refs.dialog&&t.$refs.dialog.$el.focus()})),f.f.result.momentFilter({reportType:2,clickType:5,content:t.renderOption.map((function(e){return e.tip})).join(";")})):t.renderOption=[],t.renderOption},tapSingleSelection:function(e){var t=this;e.value!==this.moment.snsContentTypeFilter?t.$store.state.result.self.base.isLoading||(t.$store.commit({type:"result/updateMoment",snsContentTypeFilter:e.value}),this.isAdvSearch?t.onSearchTap():f.a.$emit(b.b.setQuery,{}),f.f.result.momentFilter({reportType:2,clickType:6,content:e.tip}),t.typeFilterHide()):t.typeFilterHide()},typeFilterHide:function(){this.isTypeFilterActived=!1,this.renderOption=[]},handleMaskHide:function(){this.typeFilterHide()},handleTouchmovePrevent:function(e){this.isTypeFilterActived&&(e.cancelable&&e.preventDefault(),e.stopPropagation())}}},S=(i(1553),i(4)),A=Object(S.a)(O,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}]},[i("div",{staticClass:"moments-filter",class:{isPickerShow:e.isTimeActived,"moments-filter-touch-action-none":e.isTypeFilterActived}},[i("div",[i("div",{ref:"Picker",staticClass:"sift__box"},[i("span",{staticClass:"ui-aria-hidden"},[e._v("筛选器：")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isAdvSearch,expression:"isAdvSearch"},{name:"active",rawName:"v-active.stop",value:e.os.mobile,expression:"os.mobile",modifiers:{stop:!0}}],staticClass:"sift__item",attrs:{"data-index":"0",role:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.onContactTap.apply(null,arguments)},touchmove:e.handleTouchmovePrevent}},[i("div",{staticClass:"sift__item-i"},[i("div",{staticClass:"sift__item-t"},[i("div",{staticClass:"sift__item-t-text",class:{selected:e.isNameSelected}},[e._v(e._s(e.publishDisplayName))]),i("ui-arrow",{attrs:{size:"big",align:"flex",direction:"down"}})],1)])]),i("div",{directives:[{name:"active",rawName:"v-active.stop",value:e.os.mobile,expression:"os.mobile",modifiers:{stop:!0}}],staticClass:"sift__item",attrs:{role:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.onTimeTap.apply(null,arguments)},touchmove:e.handleTouchmovePrevent}},[i("div",{staticClass:"sift__item-i",class:{selected:e.isTimeActived}},[i("div",{staticClass:"sift__item-t"},[i("div",{staticClass:"sift__item-t-text",class:{selected:e.isTimeSelected}},[e._v(e._s(e.publishDisplayTime))]),i("ui-arrow",{attrs:{size:"big",align:"flex",direction:"down"}})],1)])]),e.snsContentType.length?i("div",{directives:[{name:"active",rawName:"v-active.stop",value:e.os.mobile,expression:"os.mobile",modifiers:{stop:!0}}],staticClass:"sift__item",attrs:{role:"button"},on:{click:function(t){return e.tapSift(e.snsContentType)},touchmove:e.handleTouchmovePrevent}},[i("div",{staticClass:"sift__item-i sift__item-i-type",class:{selected:e.isTypeFilterActived}},[i("div",{staticClass:"sift__item-t"},[i("div",{staticClass:"sift__item-t-text",class:{selected:e.isSnsTypeSelected}},[e._v(e._s(e.publishDisplayType))]),i("ui-arrow",{attrs:{size:"big",align:"flex",direction:"down"}})],1)])]):e._e()])])]),[e.renderOption&&e.renderOption.length?i("heightAnimate",{ref:"dialog",staticClass:"sift__multi moment-filter-sift__multi",class:{"moment-filter-sift__touch-action-none":e.isTypeFilterActived},style:e.M_os({top:e.siftOptionTop+"px"},{left:e.siftOptionLeft+"px"}),attrs:{"aria-modal":"true",tabindex:"-1"}},[i("scroll-modal",{staticClass:"sift__multi-w moment-filter-sift__touch-action-none"},e._l(e.renderOption,(function(t){return i("div",{key:t.tip,staticClass:"sift__multi-o moment-filter-sift__touch-action-none",attrs:{role:"button"},on:{click:function(i){return e.tapSingleSelection(t)}}},[i("div",{directives:[{name:"active",rawName:"v-active.stop",value:e.os.mobile,expression:"os.mobile",modifiers:{stop:!0}}],staticClass:"sift__multi-o-inner",class:{selected:t.value===e.moment.snsContentTypeFilter,active__item:e.os.pc},attrs:{"aria-label":t.value===e.moment.snsContentTypeFilter?"已选定，"+t.tip:t.tip},on:{touchmove:function(e){e.preventDefault()}}},[e._v("\n            "+e._s(t.tip)+"\n          ")])])})),0)],1):e._e()],i("transition",{attrs:{name:"showMask"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.renderOption&&e.renderOption.length,expression:"renderOption && renderOption.length"}],staticClass:"weui-mask filter-mask",style:e.M_os({top:e.siftOptionTop+"px"},{background:"transparent"}),on:{touchmove:function(e){e.preventDefault()},click:function(t){return t.stopPropagation(),e.handleMaskHide.apply(null,arguments)}}})])],2)}),[],!1,null,null,null);t.default=A.exports},652:function(e,t,i){"use strict";var n=i(24),s=i.n(n),r=i(0),a=i(46),o=i.n(a);t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.canNoLimit,i=void 0===t?[1,1,1]:t,n=e.startYear,a=void 0===n?2012:n,l=(e.pickerRef,s()(i,3)),c=l[0],u=l[1],m=l[2],p=function(e){var t=e.year,i=e.month,n=void 0===i?12:i,s=[{label:r.g.L("不限"),value:-1,children:[{label:r.g.L("不限"),value:-1}]}];u||(s=[]);for(var a=n;a>0;a--)s.push({label:r.g.L("".concat(a,"月")),value:a-1,children:h({year:t,month:a})});return s},h=function(e){var t=e.year,i=e.month,n=new Date(t,i,0).getDate();t===(new Date).getFullYear()&&i===(new Date).getMonth()+1&&(n=(new Date).getDate());var s=[{label:r.g.L("不限"),value:-1}];m||(s=[]);for(var a=n;a>0;a--)s.push({label:r.g.L("".concat(a,"日")),value:a});return s},f=function(){var e=[{label:r.g.L("不限"),value:-1,children:[{label:r.g.L("不限"),value:-1,children:[{label:r.g.L("不限"),value:-1}]}]}];c||(e=[]);var t=(new Date).getFullYear();e.push({label:t+r.g.L("年","","picker"),value:t,children:p({year:t,month:(new Date).getMonth()+1})});for(var i=t-1;i>=a;i--)e.push({label:i+r.g.L("年","","picker"),value:i,children:p({year:i})});return e}(),d=o.a.picker(f,Object.assign({title:"请选择发布时间",closeText:"取消",container:"body"},!1,e));return d}},653:function(e,t,i){},747:function(e,t,i){"use strict";i(653)},815:function(e,t,i){"use strict";var n,s={data:function(){return{}},mixins:[],props:[],methods:{touchStart:function(e){n=e.changedTouches[0].pageY},touchMove:function(e){0===this.$el.scrollTop&&e.changedTouches[0].pageY>n&&e.preventDefault(),this.$el.scrollTop+this.$el.offsetHeight===this.$el.scrollHeight&&e.changedTouches[0].pageY<n&&e.preventDefault()}},created:function(){}},r=(i(747),i(4)),a=Object(r.a)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"scroll-node",on:{touchstart:e.touchStart,touchmove:function(t){return t.stopPropagation(),e.touchMove.apply(null,arguments)}}},[e._t("default")],2)}),[],!1,null,null,null);t.a=a.exports},933:function(e,t,i){}}]);